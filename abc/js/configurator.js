function test(){$("#btnSubmit").click(function(){var t=$("#requiredFields"),n=!0;if($("#salutation").removeClass("invalid"),$("#first_name").removeClass("invalid"),$("#last_name").removeClass("invalid"),$("#address").removeClass("invalid"),$("#city").removeClass("invalid"),$("#email").removeClass("invalid"),$("#salutation").removeClass("invalid"),$("#salutation option:selected").val()==0&&($("#salutation").addClass("invalid"),n=!1),$("#first_name").val()==""&&($("#first_name").addClass("invalid"),n=!1),$("#last_name").val()==""&&($("#last_name").addClass("invalid"),n=!1),$("#address").val()==""&&($("#address").addClass("invalid"),n=!1),$("#city").val()==""&&($("#city").addClass("invalid"),n=!1),$("#email").val()==""?($("#email").addClass("invalid"),n=!1):validateEmail($("#email").val())||($("#email").addClass("invalid"),n=!1),$("#country option:selected").val()==0&&($("#country").addClass("invalid"),n=!1),$("#cmbDealerCountries option:selected").val()==0&&($("#cmbDealerCountries").addClass("invalid"),n=!1),n==!1)return $("html,body").animate({scrollTop:t.offset().top},500),t.empty().html('<p style="color: red;">PLEASE ENTER ALL OF THE REQUIRED FIELDS</p>'),!1;$btnSubmit.attr("value","Submitting...")})}function validateEmail(n){var t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return t.test(n)}(function(n){function e(i,r,f,e){var s={data:e||(r?r.data:{}),_wrap:r?r._wrap:null,tmpl:null,parent:r||null,nodes:[],calls:tt,nest:it,wrap:k,html:d,update:g};return i&&n.extend(s,i,{nodes:[],parent:r}),f&&(s.tmpl=f,s._ctnt=s._ctnt||s.tmpl(n,s),s.key=++u,(l.length?o:t)[u]=s),s}function f(t,i,u){var e,o=u?n.map(u,function(n){return typeof n=="string"?t.key?n.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+r+'="'+t.key+'" $2'):n:f(n,t,n._ctnt)}):t;return i?o:(o=o.join(""),o.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,i,r,u){e=n(r).get(),a(e),i&&(e=c(i).concat(e)),u&&(e=e.concat(c(u)))}),e?e:c(o))}function c(t){var i=document.createElement("div");return i.innerHTML=t,n.makeArray(i.childNodes)}function y(t){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+n.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,i,r,u,f,e,o){var l=n.tmpl.tag[r],a,s,c;if(!l)throw"Template command not found: "+r;return a=l._default||[],e&&!/\w$/.test(f)&&(f+=e,e=""),f?(f=h(f),o=o?","+h(o)+")":e?")":"",s=e?f.indexOf(".")>-1?f+e:"("+f+").call($item"+o:f,c=e?s:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):c=s=a.$1||"null",u=h(u),"');"+l[i?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(c).split("$1").join(s).split("$2").join(u?u.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(n,t,i,r){return r=r?","+r+")":i?")":"",r?"("+t+").call($item"+r:n}):a.$2||"")+"_.push('"})+"');}return _;")}function v(t,i){t._wrap=f(t,!0,n.isArray(i)?i:[w.test(i)?i:n(i).html()]).join("")}function h(n){return n?n.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function nt(n){var t=document.createElement("div");return t.appendChild(n.cloneNode(!0)),t.innerHTML}function a(f){function a(f){function a(n){n=n+y,s=p[n]=p[n]||e(s,t[s.parent.key+y]||s.parent,null,!0)}var v,h=f,c,s,l;if(l=f.getAttribute(r)){while(h.parentNode&&(h=h.parentNode).nodeType===1&&!(v=h.getAttribute(r)));v!==l&&(h=h.parentNode?h.nodeType===11?0:h.getAttribute(r)||0:0,(s=t[l])||(s=o[l],s=e(s,t[h]||o[h],null,!0),s.key=++u,t[u]=s),i&&a(l)),f.removeAttribute(r)}else i&&(s=n.data(f,"tmplItem"))&&(a(s.key),t[s.key]=s,h=n.data(f.parentNode,"tmplItem"),h=h?h.key:0);if(s){for(c=s;c&&c.key!=h;)c.nodes.push(f),c=c.parent;delete s._ctnt,delete s._wrap,n.data(f,"tmplItem",s)}}for(var y="_"+i,c,l,p={},s,h=0,v=f.length;h<v;h++)if((c=f[h]).nodeType===1){for(l=c.getElementsByTagName("*"),s=l.length-1;s>=0;s--)a(l[s]);a(c)}}function tt(n,t,i,r){if(!n)return l.pop();l.push({_:n,tmpl:t,item:this,data:i,options:r})}function it(t,i,r){return n.tmpl(n.template(t),i,r,this)}function k(t,i){var r=t.options||{};return r.wrapped=i,n.tmpl(n.template(t.tmpl),t.data,r,t.item)}function d(t,i){var r=this._wrap;return n.map(n(n.isArray(r)?r.join(""):r).filter(t||"*"),function(n){return i?n.innerText||n.textContent:n.outerHTML||nt(n)})}function g(){var t=this.nodes;n.tmpl(null,null,null,this).insertBefore(t[0]),n(t).remove()}var b=n.fn.domManip,r="_tmplitem",w=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,t={},o={},s,p={key:0,data:{}},u=0,i=0,l=[];n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(r,u){n.fn[r]=function(f){var o=[],h=n(f),l,e,a,v,c=this.length===1&&this[0].parentNode;if(s=t||{},c&&c.nodeType===11&&c.childNodes.length===1&&h.length===1)h[u](this[0]),o=this;else{for(e=0,a=h.length;e<a;e++)i=e,l=(e>0?this.clone(!0):this).get(),n.fn[u].apply(n(h[e]),l),o=o.concat(l);i=0,o=this.pushStack(o,r,h.selector)}return v=s,s=null,n.tmpl.complete(v),o}}),n.fn.extend({tmpl:function(t,i,r){return n.tmpl(this[0],t,i,r)},tmplItem:function(){return n.tmplItem(this[0])},template:function(t){return n.template(t,this[0])},domManip:function(r,u,f){if(r[0]&&r[0].nodeType){for(var e=n.makeArray(arguments),c=r.length,h=0,o;h<c&&!(o=n.data(r[h++],"tmplItem")););c>1&&(e[0]=[n.makeArray(r)]),o&&i&&(e[2]=function(t){n.tmpl.afterManip(this,t,f)}),b.apply(this,e)}else b.apply(this,arguments);return i=0,!s&&n.tmpl.complete(t),this}}),n.extend({tmpl:function(i,r,u,s){var h,c=!s;if(c)s=p,i=n.template[i]||n.template(null,i),o={};else if(!i)return i=s.tmpl,t[s.key]=s,s.nodes=[],s.wrapped&&v(s,s.wrapped),n(f(s,null,s.tmpl(n,s)));return i?(typeof r=="function"&&(r=r.call(s||{})),u&&u.wrapped&&v(u,u.wrapped),h=n.isArray(r)?n.map(r,function(n){return n?e(u,s,i,n):null}):[e(u,s,i,r)],c?n(f(s,null,h)):h):[]},tmplItem:function(t){var i;for(t instanceof n&&(t=t[0]);t&&t.nodeType===1&&!(i=n.data(t,"tmplItem"))&&(t=t.parentNode););return i||p},template:function(t,i){return i?(typeof i=="string"?i=y(i):i instanceof n&&(i=i[0]||{}),i.nodeType&&(i=n.data(i,"tmpl")||n.data(i,"tmpl",y(i.innerHTML))),typeof t=="string"?n.template[t]=i:i):t?typeof t!="string"?n.template(null,t):n.template[t]||n.template(null,w.test(t)?t:n(t)):null},encode:function(n){return(""+n).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),n.extend(n.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){t={}},afterManip:function(t,r,u){var f=r.nodeType===11?n.makeArray(r.childNodes):r.nodeType===1?[r]:[];u.call(t,r),a(f),i++}})})(jQuery),function(n){function k(){var t=document.getElementsByTagName("script"),n=t[t.length-1].src.split("?")[0];return n.split("/").length>0?n.split("/").slice(0,-1).join("/")+"/":""}function p(n,t,i){for(var r=0;r<t.length;r++)i(n,t[r])}var o=!1,l=!1,it=!1,nt=5e3,d=2e3,e=0,t=n,g=k(),u,f;Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var i=0,r=this.length;i<r;++i)n.call(t,this[i],i,this)});var tt=["ms","moz","webkit","o"],r=window.requestAnimationFrame||!1,i=window.cancelAnimationFrame||!1;tt.forEach(function(n){r||(r=window[n+"RequestAnimationFrame"]),i||(i=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"])});var h=window.MutationObserver||window.WebKitMutationObserver||!1,v={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:!1,cursordragontouch:!1},c=!1,b=function(){function f(){var u=["-moz-grab","-webkit-grab","grab"],r,i;for((n.ischrome&&!n.ischrome22||n.isie)&&(u=[]),r=0;r<u.length;r++)if(i=u[r],t.style.cursor=i,t.style.cursor==i)return i;return"url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize"}var t,n,r,i;if(c)return c;for(t=document.createElement("DIV"),n={},n.haspointerlock=("pointerLockElement"in document)||("mozPointerLockElement"in document)||("webkitPointerLockElement"in document),n.isopera=("opera"in window),n.isopera12=n.isopera&&("getUserMedia"in navigator),n.isie=("all"in document)&&("attachEvent"in t)&&!n.isopera,n.isieold=n.isie&&!("msInterpolationMode"in t.style),n.isie7=n.isie&&!n.isieold&&(!("documentMode"in document)||document.documentMode==7),n.isie8=n.isie&&("documentMode"in document)&&document.documentMode==8,n.isie9=n.isie&&("performance"in window)&&document.documentMode>=9,n.isie10=n.isie&&("performance"in window)&&document.documentMode>=10,n.isie9mobile=/iemobile.9/i.test(navigator.userAgent),n.isie9mobile&&(n.isie9=!1),n.isie7mobile=!n.isie9mobile&&n.isie7&&/iemobile/i.test(navigator.userAgent),n.ismozilla=("MozAppearance"in t.style),n.iswebkit=("WebkitAppearance"in t.style),n.ischrome=("chrome"in window),n.ischrome22=n.ischrome&&n.haspointerlock,n.ischrome26=n.ischrome&&("transition"in t.style),n.cantouch=("ontouchstart"in document.documentElement)||("ontouchstart"in window),n.hasmstouch=window.navigator.msPointerEnabled||!1,n.ismac=/^mac$/i.test(navigator.platform),n.isios=n.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform),n.isios4=n.isios&&!("seal"in Object),n.isandroid=/android/i.test(navigator.userAgent),n.trstyle=!1,n.hastransform=!1,n.hastranslate3d=!1,n.transitionstyle=!1,n.hastransition=!1,n.transitionend=!1,r=["transform","msTransform","webkitTransform","MozTransform","OTransform"],i=0;i<r.length;i++)if(typeof t.style[r[i]]!="undefined"){n.trstyle=r[i];break}n.hastransform=n.trstyle!=!1,n.hastransform&&(t.style[n.trstyle]="translate3d(1px,2px,3px)",n.hastranslate3d=/translate3d/.test(t.style[n.trstyle])),n.transitionstyle=!1,n.prefixstyle="",n.transitionend=!1;var r=["transition","webkitTransition","MozTransition","OTransition","OTransition","msTransition","KhtmlTransition"],u=["","-webkit-","-moz-","-o-","-o","-ms-","-khtml-"],e=["transitionend","webkitTransitionEnd","transitionend","otransitionend","oTransitionEnd","msTransitionEnd","KhtmlTransitionEnd"];for(i=0;i<r.length;i++)if(r[i]in t.style){n.transitionstyle=r[i],n.prefixstyle=u[i],n.transitionend=e[i];break}return n.ischrome26&&(n.prefixstyle=u[1]),n.hastransition=n.transitionstyle,n.cursorgrabvalue=f(),n.hasmousecapture="setCapture"in t,n.hasMutationObserver=h!==!1,t=null,c=n,n},w=function(n,u){function it(){var n=f.win,t;if("zIndex"in n)return n.zIndex();while(n.length>0){if(n[0].nodeType==9)return!1;if(t=n.css("zIndex"),!isNaN(t)&&t!=0)return parseInt(t);n=n.parent()}return!1}function c(n,t,i){var e=n.css(t),r=parseFloat(e),u;return isNaN(r)?(r=tt[e]||0,u=r==3?i?f.win.outerHeight()-f.win.innerHeight():f.win.outerWidth()-f.win.innerWidth():1,f.isie8&&r&&(r+=1),u?r:0):r}function w(n,t,i,r){f._bind(n,t,function(r){var r=r?r:window.event,u={original:r,target:r.target||r.srcElement,type:"wheel",deltaMode:r.type=="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return r.preventDefault?r.preventDefault():r.returnValue=!1,!1},stopImmediatePropagation:function(){r.stopImmediatePropagation?r.stopImmediatePropagation():r.cancelBubble=!0}};return t=="mousewheel"?(u.deltaY=-1/40*r.wheelDelta,r.wheelDeltaX&&(u.deltaX=-1/40*r.wheelDeltaX)):u.deltaY=r.detail,i.call(n,u)},r)}function p(n,t,i){var u,r,e=1;if(n.deltaMode==0?(u=-Math.floor(n.deltaX*(f.opt.mousescrollstep/54)),r=-Math.floor(n.deltaY*(f.opt.mousescrollstep/54))):n.deltaMode==1&&(u=-Math.floor(n.deltaX*f.opt.mousescrollstep),r=-Math.floor(n.deltaY*f.opt.mousescrollstep)),t&&u==0&&r&&(u=r,r=0),u&&(f.scrollmom&&f.scrollmom.stop(),f.lastdeltax+=u,f.debounced("mousewheelx",function(){var n=f.lastdeltax;f.lastdeltax=0,f.rail.drag||f.doScrollLeftBy(n)},120)),r){if(f.opt.nativeparentscrolling&&i&&!f.ispage&&!f.zoomactive)if(r<0){if(f.getScrollTop()>=f.page.maxh)return!0}else if(f.getScrollTop()<=0)return!0;f.scrollmom&&f.scrollmom.stop(),f.lastdeltay+=r,f.debounced("mousewheely",function(){var n=f.lastdeltay;f.lastdeltay=0,f.rail.drag||f.doScrollBy(n)},120)}return n.stopImmediatePropagation(),n.preventDefault()}var f=this,a,s,tt;if(this.version="3.4.1",this.name="nicescroll",this.me=u,this.opt={doc:t("body"),win:!1},t.extend(this.opt,v),this.opt.snapbackspeed=80,n||!1)for(a in f.opt)typeof n[a]!="undefined"&&(f.opt[a]=n[a]);this.doc=f.opt.doc,this.iddoc=this.doc&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/BODY|HTML/.test(f.opt.win?f.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=f.opt.win!==!1,this.win=f.opt.win||(this.ispage?t(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?t(window):this.win,this.body=t("body"),this.viewport=!1,this.isfixed=!1,this.iframe=!1,this.isiframe=this.doc[0].nodeName=="IFRAME"&&this.win[0].nodeName=="IFRAME",this.istextarea=this.win[0].nodeName=="TEXTAREA",this.forcescreen=!1,this.canshowonmouseevent=f.opt.autohidemode!="scroll",this.onmousedown=!1,this.onmouseup=!1,this.onmousemove=!1,this.onmousewheel=!1,this.onkeypress=!1,this.ongesturezoom=!1,this.onclick=!1,this.onscrollstart=!1,this.onscrollend=!1,this.onscrollcancel=!1,this.onzoomin=!1,this.onzoomout=!1,this.view=!1,this.page=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.checkrtlmode=!1,this.scrollrunning=!1,this.scrollmom=!1,this.observer=!1,this.observerremover=!1;do this.id="ascrail"+d++;while(document.getElementById(this.id));if(this.rail=!1,this.cursor=!1,this.cursorfreezed=!1,this.selectiondrag=!1,this.zoom=!1,this.zoomactive=!1,this.hasfocus=!1,this.hasmousefocus=!1,this.visibility=!0,this.locked=!1,this.hidden=!1,this.cursoractive=!0,this.overflowx=f.opt.overflowx,this.overflowy=f.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltax=0,this.lastdeltay=0,this.detected=b(),s=t.extend({},this.detected),this.canhwscroll=s.hastransform&&f.opt.hwacceleration,this.ishwscroll=this.canhwscroll&&f.haswrapper,this.istouchcapable=!1,s.cantouch&&s.ischrome&&!s.isios&&!s.isandroid&&(this.istouchcapable=!0,s.cantouch=!1),s.cantouch&&s.ismozilla&&!s.isios&&(this.istouchcapable=!0,s.cantouch=!1),f.opt.enablemouselockapi||(s.hasmousecapture=!1,s.haspointerlock=!1),this.delayed=function(n,t,i,r){var u=f.delaylist[n],e=+new Date;if(!r&&u&&u.tt)return!1;u&&u.tt&&clearTimeout(u.tt),u&&u.last+i>e&&!u.tt?f.delaylist[n]={last:e+i,tt:setTimeout(function(){f.delaylist[n].tt=0,t.call()},i)}:u&&u.tt||(f.delaylist[n]={last:e,tt:0},setTimeout(function(){t.call()},0))},this.debounced=function(n,t,i){var r=f.delaylist[n],u=+new Date;f.delaylist[n]=t,r||setTimeout(function(){var t=f.delaylist[n];f.delaylist[n]=!1,t.call()},i)},this.synched=function(n,t){function i(){f.onsync||(r(function(){f.onsync=!1;for(n in f.synclist){var t=f.synclist[n];t&&t.call(f),f.synclist[n]=!1}}),f.onsync=!0)}return f.synclist[n]=t,i(),n},this.unsynched=function(n){f.synclist[n]&&(f.synclist[n]=!1)},this.css=function(n,t){for(var i in t)f.saved.css.push([n,i,n.css(i)]),n.css(i,t[i])},this.scrollTop=function(n){return typeof n=="undefined"?f.getScrollTop():f.setScrollTop(n)},this.scrollLeft=function(n){return typeof n=="undefined"?f.getScrollLeft():f.setScrollLeft(n)},BezierClass=function(n,t,i,r,u,f,e){this.st=n,this.ed=t,this.spd=i,this.p1=r||0,this.p2=u||1,this.p3=f||0,this.p4=e||1,this.ts=+new Date,this.df=this.ed-this.st},BezierClass.prototype={B2:function(n){return 3*n*n*(1-n)},B3:function(n){return 3*n*(1-n)*(1-n)},B4:function(n){return(1-n)*(1-n)*(1-n)},getNow:function(){var i=+new Date,n=1-(i-this.ts)/this.spd,t=this.B2(n)+this.B3(n)+this.B4(n);return n<0?this.ed:this.st+Math.round(this.df*t)},update:function(n,t){return this.st=this.getNow(),this.ed=n,this.spd=t,this.ts=+new Date,this.df=this.ed-this.st,this}},this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},s.hastranslate3d&&s.isios&&this.doc.css("-webkit-backface-visibility","hidden");function k(){var n=f.doc.css(s.trstyle);return n&&n.substr(0,6)=="matrix"?n.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/):!1}this.getScrollTop=function(n){if(!n){var t=k();if(t)return t.length==16?-t[13]:-t[5];if(f.timerscroll&&f.timerscroll.bz)return f.timerscroll.bz.getNow()}return f.doc.translate.y},this.getScrollLeft=function(n){if(!n){var t=k();if(t)return t.length==16?-t[12]:-t[4];if(f.timerscroll&&f.timerscroll.bh)return f.timerscroll.bh.getNow()}return f.doc.translate.x},this.notifyScrollEvent=document.createEvent?function(n){var t=document.createEvent("UIEvents");t.initUIEvent("scroll",!1,!0,window,1),n.dispatchEvent(t)}:document.fireEvent?function(n){var t=document.createEventObject();n.fireEvent("onscroll"),t.cancelBubble=!0}:function(){},s.hastranslate3d&&f.opt.enabletranslate3d?(this.setScrollTop=function(n,t){f.doc.translate.y=n,f.doc.translate.ty=n*-1+"px",f.doc.css(s.trstyle,"translate3d("+f.doc.translate.tx+","+f.doc.translate.ty+",0px)"),t||f.notifyScrollEvent(f.win[0])},this.setScrollLeft=function(n,t){f.doc.translate.x=n,f.doc.translate.tx=n*-1+"px",f.doc.css(s.trstyle,"translate3d("+f.doc.translate.tx+","+f.doc.translate.ty+",0px)"),t||f.notifyScrollEvent(f.win[0])}):(this.setScrollTop=function(n,t){f.doc.translate.y=n,f.doc.translate.ty=n*-1+"px",f.doc.css(s.trstyle,"translate("+f.doc.translate.tx+","+f.doc.translate.ty+")"),t||f.notifyScrollEvent(f.win[0])},this.setScrollLeft=function(n,t){f.doc.translate.x=n,f.doc.translate.tx=n*-1+"px",f.doc.css(s.trstyle,"translate("+f.doc.translate.tx+","+f.doc.translate.ty+")"),t||f.notifyScrollEvent(f.win[0])})}else this.getScrollTop=function(){return f.docscroll.scrollTop()},this.setScrollTop=function(n){return f.docscroll.scrollTop(n)},this.getScrollLeft=function(){return f.docscroll.scrollLeft()},this.setScrollLeft=function(n){return f.docscroll.scrollLeft(n)};this.getTarget=function(n){return n?n.target?n.target:n.srcElement?n.srcElement:!1:!1},this.hasParent=function(n,t){if(!n)return!1;for(var i=n.target||n.srcElement||n||!1;i&&i.id!=t;)i=i.parentNode||!1;return i!==!1},tt={thin:1,medium:3,thick:5},this.getOffset=function(){if(f.isfixed)return{top:parseFloat(f.win.css("top")),left:parseFloat(f.win.css("left"))};if(!f.viewport)return f.win.offset();var t=f.win.offset(),n=f.viewport.offset();return{top:t.top-n.top+f.viewport.scrollTop(),left:t.left-n.left+f.viewport.scrollLeft()}},this.updateScrollBar=function(n){var r,t,o,i;if(f.ishwscroll)f.rail.css({height:f.win.innerHeight()}),f.railh&&f.railh.css({width:f.win.innerWidth()});else if(r=f.getOffset(),t={top:r.top,left:r.left},t.top+=c(f.win,"border-top-width",!0),o=(f.win.outerWidth()-f.win.innerWidth())/2,t.left+=f.rail.align?f.win.outerWidth()-c(f.win,"border-right-width")-f.rail.width:c(f.win,"border-left-width"),i=f.opt.railoffset,i&&(i.top&&(t.top+=i.top),f.rail.align&&i.left&&(t.left+=i.left)),f.locked||f.rail.css({top:t.top,left:t.left,height:n?n.h:f.win.innerHeight()}),f.zoom&&f.zoom.css({top:t.top+1,left:f.rail.align==1?t.left-20:t.left+f.rail.width+4}),f.railh&&!f.locked){var t={top:r.top,left:r.left},e=f.railh.align?t.top+c(f.win,"border-top-width",!0)+f.win.innerHeight()-f.railh.height:t.top+c(f.win,"border-top-width",!0),u=t.left+c(f.win,"border-left-width");f.railh.css({top:e,left:u,width:f.railh.width})}},this.doRailClick=function(n,t,i){var r,e,u,o;f.locked||(f.cancelEvent(n),t?(r=i?f.doScrollLeft:f.doScrollTop,u=i?(n.pageX-f.railh.offset().left-f.cursorwidth/2)*f.scrollratio.x:(n.pageY-f.rail.offset().top-f.cursorheight/2)*f.scrollratio.y,r(u)):(r=i?f.doScrollLeftBy:f.doScrollBy,u=i?f.scroll.x:f.scroll.y,o=i?n.pageX-f.railh.offset().left:n.pageY-f.rail.offset().top,e=i?f.view.w:f.view.h,u>=o?r(e):r(-e)))},f.hasanimationframe=r,f.hascancelanimationframe=i,f.hasanimationframe?f.hascancelanimationframe||(i=function(){f.cancelAnimationFrame=!0}):(r=function(n){return setTimeout(n,15-Math.floor(+new Date/1e3)%16)},i=clearInterval),this.init=function(){var u,n,b,p,d,ft,c,r,i,v,a,w,k,et,tt,rt;if(f.saved.css=[],s.isie7mobile)return!0;if(s.hasmstouch&&f.css(f.ispage?t("html"):f.win,{"-ms-touch-action":"none"}),f.zindex="auto",f.zindex=f.ispage||f.opt.zindex!="auto"?f.opt.zindex:it()||"auto",f.ispage||f.zindex=="auto"||f.zindex>e&&(e=f.zindex),f.isie&&f.zindex==0&&f.opt.zindex=="auto"&&(f.zindex="auto"),!f.ispage||!s.cantouch&&!s.isieold&&!s.isie9mobile){u=f.docscroll,f.ispage&&(u=f.haswrapper?f.win:f.doc),s.isie9mobile||f.css(u,{"overflow-y":"hidden"}),f.ispage&&s.isie7&&(f.doc[0].nodeName=="BODY"?f.css(t("html"),{"overflow-y":"hidden"}):f.doc[0].nodeName=="HTML"&&f.css(t("body"),{"overflow-y":"hidden"})),!s.isios||f.ispage||f.haswrapper||f.css(t("body"),{"-webkit-overflow-scrolling":"touch"}),r=t(document.createElement("div")),r.css({position:"relative",top:0,float:"right",width:f.opt.cursorwidth,height:"0px","background-color":f.opt.cursorcolor,border:f.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":f.opt.cursorborderradius,"-moz-border-radius":f.opt.cursorborderradius,"border-radius":f.opt.cursorborderradius}),r.hborder=parseFloat(r.outerHeight()-r.innerHeight()),f.cursor=r,n=t(document.createElement("div")),n.attr("id",f.id),n.addClass("nicescroll-rails"),d=["left","right"];for(ft in d)p=d[ft],b=f.opt.railpadding[p],b?n.css("padding-"+p,b+"px"):f.opt.railpadding[p]=0;if(n.append(r),n.width=Math.max(parseFloat(f.opt.cursorwidth),r.outerWidth())+f.opt.railpadding.left+f.opt.railpadding.right,n.css({width:n.width+"px",zIndex:f.zindex,background:f.opt.background,cursor:"default"}),n.visibility=!0,n.scrollable=!0,n.align=f.opt.railalign=="left"?0:1,f.rail=n,f.rail.drag=!1,c=!1,!f.opt.boxzoom||f.ispage||s.isieold||(c=document.createElement("div"),f.bind(c,"click",f.doZoom),f.zoom=t(c),f.zoom.css({cursor:"pointer","z-index":f.zindex,backgroundImage:"url("+g+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),f.opt.dblclickzoom&&f.bind(f.win,"dblclick",f.doZoom),s.cantouch&&f.opt.gesturezoom&&(f.ongesturezoom=function(n){return n.scale>1.5&&f.doZoomIn(n),n.scale<.8&&f.doZoomOut(n),f.cancelEvent(n)},f.bind(f.win,"gestureend",f.ongesturezoom))),f.railh=!1,f.opt.horizrailenabled&&(f.css(u,{"overflow-x":"hidden"}),r=t(document.createElement("div")),r.css({position:"relative",top:0,height:f.opt.cursorwidth,width:"0px","background-color":f.opt.cursorcolor,border:f.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":f.opt.cursorborderradius,"-moz-border-radius":f.opt.cursorborderradius,"border-radius":f.opt.cursorborderradius}),r.wborder=parseFloat(r.outerWidth()-r.innerWidth()),f.cursorh=r,i=t(document.createElement("div")),i.attr("id",f.id+"-hr"),i.addClass("nicescroll-rails"),i.height=Math.max(parseFloat(f.opt.cursorwidth),r.outerHeight()),i.css({height:i.height+"px",zIndex:f.zindex,background:f.opt.background}),i.append(r),i.visibility=!0,i.scrollable=!0,i.align=f.opt.railvalign=="top"?0:1,f.railh=i,f.railh.drag=!1),f.ispage?(n.css({position:"fixed",top:"0px",height:"100%"}),n.align?n.css({right:"0px"}):n.css({left:"0px"}),f.body.append(n),f.railh&&(i.css({position:"fixed",left:"0px",width:"100%"}),i.align?i.css({bottom:"0px"}):i.css({top:"0px"}),f.body.append(i))):(f.ishwscroll?(f.win.css("position")=="static"&&f.css(f.win,{position:"relative"}),v=f.win[0].nodeName=="HTML"?f.body:f.win,f.zoom&&(f.zoom.css({position:"absolute",top:1,right:0,"margin-right":n.width+4}),v.append(f.zoom)),n.css({position:"absolute",top:0}),n.align?n.css({right:0}):n.css({left:0}),v.append(n),i&&(i.css({position:"absolute",left:0,bottom:0}),i.align?i.css({bottom:0}):i.css({top:0}),v.append(i))):(f.isfixed=f.win.css("position")=="fixed",a=f.isfixed?"fixed":"absolute",f.isfixed||(f.viewport=f.getViewport(f.win[0])),f.viewport&&(f.body=f.viewport,/relative|absolute/.test(f.viewport.css("position"))==!1&&f.css(f.viewport,{position:"relative"})),n.css({position:a}),f.zoom&&f.zoom.css({position:a}),f.updateScrollBar(),f.body.append(n),f.zoom&&f.body.append(f.zoom),f.railh&&(i.css({position:a}),f.body.append(i))),s.isios&&f.css(f.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),s.isie&&f.opt.disableoutline&&f.win.attr("hideFocus","true"),s.iswebkit&&f.opt.disableoutline&&f.win.css({outline:"none"})),f.opt.autohidemode===!1?(f.autohidedom=!1,f.rail.css({opacity:f.opt.cursoropacitymax}),f.railh&&f.railh.css({opacity:f.opt.cursoropacitymax})):f.opt.autohidemode===!0?(f.autohidedom=t().add(f.rail),s.isie8&&(f.autohidedom=f.autohidedom.add(f.cursor)),f.railh&&(f.autohidedom=f.autohidedom.add(f.railh)),f.railh&&s.isie8&&(f.autohidedom=f.autohidedom.add(f.cursorh))):f.opt.autohidemode=="scroll"?(f.autohidedom=t().add(f.rail),f.railh&&(f.autohidedom=f.autohidedom.add(f.railh))):f.opt.autohidemode=="cursor"?(f.autohidedom=t().add(f.cursor),f.railh&&(f.autohidedom=f.autohidedom.add(f.cursorh))):f.opt.autohidemode=="hidden"&&(f.autohidedom=!1,f.hide(),f.locked=!1),s.isie9mobile)f.scrollmom=new y(f),f.onmangotouch=function(){var i=f.getScrollTop(),t=f.getScrollLeft(),l,s;if(i==f.scrollmom.lastscrolly&&t==f.scrollmom.lastscrollx)return!0;var e=i-f.mangotouch.sy,u=t-f.mangotouch.sx,c=Math.round(Math.sqrt(Math.pow(u,2)+Math.pow(e,2)));if(c!=0){var h=e<0?-1:1,o=u<0?-1:1,r=+new Date;f.mangotouch.lazy&&clearTimeout(f.mangotouch.lazy),r-f.mangotouch.tm>80||f.mangotouch.dry!=h||f.mangotouch.drx!=o?(f.scrollmom.stop(),f.scrollmom.reset(t,i),f.mangotouch.sy=i,f.mangotouch.ly=i,f.mangotouch.sx=t,f.mangotouch.lx=t,f.mangotouch.dry=h,f.mangotouch.drx=o,f.mangotouch.tm=r):(f.scrollmom.stop(),f.scrollmom.update(f.mangotouch.sx-u,f.mangotouch.sy-e),l=r-f.mangotouch.tm,f.mangotouch.tm=r,s=Math.max(Math.abs(f.mangotouch.ly-i),Math.abs(f.mangotouch.lx-t)),f.mangotouch.ly=i,f.mangotouch.lx=t,s>2&&(f.mangotouch.lazy=setTimeout(function(){f.mangotouch.lazy=!1,f.mangotouch.dry=0,f.mangotouch.drx=0,f.mangotouch.tm=0,f.scrollmom.doMomentum(30)},100)))}},w=f.getScrollTop(),k=f.getScrollLeft(),f.mangotouch={sy:w,ly:w,dry:0,sx:k,lx:k,drx:0,lazy:!1,tm:0},f.bind(f.docscroll,"scroll",f.onmangotouch);else{if((s.cantouch||f.istouchcapable||f.opt.touchbehavior||s.hasmstouch)&&(f.scrollmom=new y(f),f.ontouchstart=function(n){var r,i,l,e,n,u,o;if(n.pointerType&&n.pointerType!=2)return!1;if(!f.locked){if(s.hasmstouch)for(i=n.target?n.target:!1;i;){if(r=t(i).getNiceScroll(),r.length>0&&r[0].me==f.me)break;if(r.length>0)return!1;if(i.nodeName=="DIV"&&i.id==f.id)break;i=i.parentNode?i.parentNode:!1}if(f.cancelScroll(),i=f.getTarget(n),i&&(l=/INPUT/i.test(i.nodeName)&&/range/i.test(i.type),l))return f.stopPropagation(n);if(!("clientX"in n)&&"changedTouches"in n&&(n.clientX=n.changedTouches[0].clientX,n.clientY=n.changedTouches[0].clientY),f.forcescreen&&(e=n,n={original:n.original?n.original:n},n.clientX=e.screenX,n.clientY=e.screenY),f.rail.drag={x:n.clientX,y:n.clientY,sx:f.scroll.x,sy:f.scroll.y,st:f.getScrollTop(),sl:f.getScrollLeft(),pt:2,dl:!1},f.ispage||!f.opt.directionlockdeadzone)f.rail.drag.dl="f";else{var c={w:t(window).width(),h:t(window).height()},h={w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},a=Math.max(0,h.h-c.h),v=Math.max(0,h.w-c.w);f.rail.drag.ck=!f.rail.scrollable&&f.railh.scrollable?a>0?"v":!1:f.rail.scrollable&&!f.railh.scrollable?v>0?"h":!1:!1,f.rail.drag.ck||(f.rail.drag.dl="f")}if(f.opt.touchbehavior&&f.isiframe&&s.isie&&(u=f.win.position(),f.rail.drag.x+=u.left,f.rail.drag.y+=u.top),f.hasmoving=!1,f.lastmouseup=!1,f.scrollmom.reset(n.clientX,n.clientY),!s.cantouch&&!this.istouchcapable&&!s.hasmstouch){if(o=i?/INPUT|SELECT|TEXTAREA/i.test(i.nodeName):!1,!o)return!f.ispage&&s.hasmousecapture&&i.setCapture(),f.cancelEvent(n);/SUBMIT|CANCEL|BUTTON/i.test(t(i).attr("type"))&&(pc={tg:i,click:!1},f.preventclick=pc)}}},f.ontouchend=function(n){return n.pointerType&&n.pointerType!=2?!1:f.rail.drag&&f.rail.drag.pt==2&&(f.scrollmom.doMomentum(),f.rail.drag=!1,f.hasmoving&&(f.hasmoving=!1,f.lastmouseup=!0,f.hideCursor(),s.hasmousecapture&&document.releaseCapture(),!s.cantouch))?f.cancelEvent(n):void 0},et=f.opt.touchbehavior&&f.isiframe&&!s.hasmousecapture,f.ontouchmove=function(n,i){var k,a,n,y,p,u,h;if(n.pointerType&&n.pointerType!=2)return!1;if(f.rail.drag&&f.rail.drag.pt==2){if(s.cantouch&&typeof n.original=="undefined")return!0;f.hasmoving=!0,f.preventclick&&!f.preventclick.click&&(f.preventclick.click=f.preventclick.tg.onclick||!1,f.preventclick.tg.onclick=f.onpreventclick),k=t.extend({original:n},n),n=k,"changedTouches"in n&&(n.clientX=n.changedTouches[0].clientX,n.clientY=n.changedTouches[0].clientY),f.forcescreen&&(a=n,n={original:n.original?n.original:n},n.clientX=a.screenX,n.clientY=a.screenY),y=ofy=0,et&&!i&&(p=f.win.position(),y=-p.left,ofy=-p.top);var l=n.clientY+ofy,w=l-f.rail.drag.y,e=n.clientX+y,b=e-f.rail.drag.x,r=f.rail.drag.st-w;if(f.ishwscroll&&f.opt.bouncescroll?r<0?r=Math.round(r/2):r>f.page.maxh&&(r=f.page.maxh+Math.round((r-f.page.maxh)/2)):(r<0&&(r=0,l=0),r>f.page.maxh&&(r=f.page.maxh,l=0)),f.railh&&f.railh.scrollable&&(u=f.rail.drag.sl-b,f.ishwscroll&&f.opt.bouncescroll?u<0?u=Math.round(u/2):u>f.page.maxw&&(u=f.page.maxw+Math.round((u-f.page.maxw)/2)):(u<0&&(u=0,e=0),u>f.page.maxw&&(u=f.page.maxw,e=0))),h=!1,f.rail.drag.dl)h=!0,f.rail.drag.dl=="v"?u=f.rail.drag.sl:f.rail.drag.dl=="h"&&(r=f.rail.drag.st);else{var o=Math.abs(w),v=Math.abs(b),c=f.opt.directionlockdeadzone;if(f.rail.drag.ck=="v"){if(o>c&&v<=o*.3)return f.rail.drag=!1,!0;v>c&&(f.rail.drag.dl="f",t("body").scrollTop(t("body").scrollTop()))}else if(f.rail.drag.ck=="h"){if(v>c&&o<=az*.3)return f.rail.drag=!1,!0;o>c&&(f.rail.drag.dl="f",t("body").scrollLeft(t("body").scrollLeft()))}}if(f.synched("touchmove",function(){f.rail.drag&&f.rail.drag.pt==2&&(f.prepareTransition&&f.prepareTransition(0),f.rail.scrollable&&f.setScrollTop(r),f.scrollmom.update(e,l),f.railh&&f.railh.scrollable?(f.setScrollLeft(u),f.showCursor(r,u)):f.showCursor(r),s.isie10&&document.selection.clear())}),s.ischrome&&f.istouchcapable&&(h=!1),h)return f.cancelEvent(n)}}),f.onmousedown=function(n,t){if(!f.rail.drag||f.rail.drag.pt==1){if(f.locked)return f.cancelEvent(n);f.cancelScroll(),f.rail.drag={x:n.clientX,y:n.clientY,sx:f.scroll.x,sy:f.scroll.y,pt:1,hr:!!t};var i=f.getTarget(n);return!f.ispage&&s.hasmousecapture&&i.setCapture(),f.isiframe&&!s.hasmousecapture&&(f.saved.csspointerevents=f.doc.css("pointer-events"),f.css(f.doc,{"pointer-events":"none"})),f.cancelEvent(n)}},f.onmouseup=function(n){if(f.rail.drag)return(s.hasmousecapture&&document.releaseCapture(),f.isiframe&&!s.hasmousecapture&&f.doc.css("pointer-events",f.saved.csspointerevents),f.rail.drag.pt!=1)?void 0:(f.rail.drag=!1,f.cancelEvent(n))},f.onmousemove=function(n){var i,t;if(f.rail.drag)return f.rail.drag.pt!=1?void 0:s.ischrome&&n.which==0?f.onmouseup(n):(f.cursorfreezed=!0,f.rail.drag.hr?(f.scroll.x=f.rail.drag.sx+(n.clientX-f.rail.drag.x),f.scroll.x<0&&(f.scroll.x=0),i=f.scrollvaluemaxw,f.scroll.x>i&&(f.scroll.x=i)):(f.scroll.y=f.rail.drag.sy+(n.clientY-f.rail.drag.y),f.scroll.y<0&&(f.scroll.y=0),t=f.scrollvaluemax,f.scroll.y>t&&(f.scroll.y=t)),f.synched("mousemove",function(){f.rail.drag&&f.rail.drag.pt==1&&(f.showCursor(),f.rail.drag.hr?f.doScrollLeft(Math.round(f.scroll.x*f.scrollratio.x),f.opt.cursordragspeed):f.doScrollTop(Math.round(f.scroll.y*f.scrollratio.y),f.opt.cursordragspeed))}),f.cancelEvent(n))},s.cantouch||f.opt.touchbehavior)f.onpreventclick=function(n){if(f.preventclick)return f.preventclick.tg.onclick=f.preventclick.click,f.preventclick=!1,f.cancelEvent(n)},f.bind(f.win,"mousedown",f.ontouchstart),f.onclick=s.isios?!1:function(n){return f.lastmouseup?(f.lastmouseup=!1,f.cancelEvent(n)):!0},f.opt.grabcursorenabled&&s.cursorgrabvalue&&(f.css(f.ispage?f.doc:f.win,{cursor:s.cursorgrabvalue}),f.css(f.rail,{cursor:s.cursorgrabvalue}));else{function ot(n){var i,t,r;f.selectiondrag&&(n&&(i=f.win.outerHeight(),t=n.pageY-f.selectiondrag.top,t>0&&t<i&&(t=0),t>=i&&(t-=i),f.selectiondrag.df=t),f.selectiondrag.df!=0)&&(r=-Math.floor(f.selectiondrag.df/6)*2,f.doScrollBy(r),f.debounced("doselectionscroll",function(){ot()},50))}f.hasTextSelected="getSelection"in document?function(){return document.getSelection().rangeCount>0}:"selection"in document?function(){return document.selection.type!="None"}:function(){return!1},f.onselectionstart=function(){f.ispage||(f.selectiondrag=f.win.offset())},f.onselectionend=function(){f.selectiondrag=!1},f.onselectiondrag=function(n){f.selectiondrag&&f.hasTextSelected()&&f.debounced("selectionscroll",function(){ot(n)},250)}}s.hasmstouch&&(f.css(f.rail,{"-ms-touch-action":"none"}),f.css(f.cursor,{"-ms-touch-action":"none"}),f.bind(f.win,"MSPointerDown",f.ontouchstart),f.bind(document,"MSPointerUp",f.ontouchend),f.bind(document,"MSPointerMove",f.ontouchmove),f.bind(f.cursor,"MSGestureHold",function(n){n.preventDefault()}),f.bind(f.cursor,"contextmenu",function(n){n.preventDefault()})),this.istouchcapable&&(f.bind(f.win,"touchstart",f.ontouchstart),f.bind(document,"touchend",f.ontouchend),f.bind(document,"touchcancel",f.ontouchend),f.bind(document,"touchmove",f.ontouchmove)),f.bind(f.cursor,"mousedown",f.onmousedown),f.bind(f.cursor,"mouseup",f.onmouseup),f.railh&&(f.bind(f.cursorh,"mousedown",function(n){f.onmousedown(n,!0)}),f.bind(f.cursorh,"mouseup",function(n){if(!f.rail.drag||f.rail.drag.pt!=2)return f.rail.drag=!1,f.hasmoving=!1,f.hideCursor(),s.hasmousecapture&&document.releaseCapture(),f.cancelEvent(n)})),!f.opt.cursordragontouch&&(s.cantouch||f.opt.touchbehavior)||(f.rail.css({cursor:"default"}),f.railh&&f.railh.css({cursor:"default"}),f.jqbind(f.rail,"mouseenter",function(){f.canshowonmouseevent&&f.showCursor(),f.rail.active=!0}),f.jqbind(f.rail,"mouseleave",function(){f.rail.active=!1,f.rail.drag||f.hideCursor()}),f.opt.sensitiverail&&(f.bind(f.rail,"click",function(n){f.doRailClick(n,!1,!1)}),f.bind(f.rail,"dblclick",function(n){f.doRailClick(n,!0,!1)}),f.bind(f.cursor,"click",function(n){f.cancelEvent(n)}),f.bind(f.cursor,"dblclick",function(n){f.cancelEvent(n)})),f.railh&&(f.jqbind(f.railh,"mouseenter",function(){f.canshowonmouseevent&&f.showCursor(),f.rail.active=!0}),f.jqbind(f.railh,"mouseleave",function(){f.rail.active=!1,f.rail.drag||f.hideCursor()}),f.opt.sensitiverail&&(f.bind(f.railh,"click",function(n){f.doRailClick(n,!1,!0)}),f.bind(f.railh,"dblclick",function(n){f.doRailClick(n,!0,!0)}),f.bind(f.cursorh,"click",function(n){f.cancelEvent(n)}),f.bind(f.cursorh,"dblclick",function(n){f.cancelEvent(n)})))),s.cantouch||f.opt.touchbehavior?(f.bind(s.hasmousecapture?f.win:document,"mouseup",f.ontouchend),f.bind(document,"mousemove",f.ontouchmove),f.onclick&&f.bind(document,"click",f.onclick),f.opt.cursordragontouch&&(f.bind(f.cursor,"mousedown",f.onmousedown),f.bind(f.cursor,"mousemove",f.onmousemove),f.cursorh&&f.bind(f.cursorh,"mousedown",f.onmousedown),f.cursorh&&f.bind(f.cursorh,"mousemove",f.onmousemove))):(f.bind(s.hasmousecapture?f.win:document,"mouseup",f.onmouseup),f.bind(document,"mousemove",f.onmousemove),f.onclick&&f.bind(document,"click",f.onclick),!f.ispage&&f.opt.enablescrollonselection&&(f.bind(f.win[0],"mousedown",f.onselectionstart),f.bind(document,"mouseup",f.onselectionend),f.bind(f.cursor,"mouseup",f.onselectionend),f.cursorh&&f.bind(f.cursorh,"mouseup",f.onselectionend),f.bind(document,"mousemove",f.onselectiondrag)),f.zoom&&(f.jqbind(f.zoom,"mouseenter",function(){f.canshowonmouseevent&&f.showCursor(),f.rail.active=!0}),f.jqbind(f.zoom,"mouseleave",function(){f.rail.active=!1,f.rail.drag||f.hideCursor()}))),f.opt.enablemousewheel&&(f.isiframe||f.bind(s.isie&&f.ispage?document:f.docscroll,"mousewheel",f.onmousewheel),f.bind(f.rail,"mousewheel",f.onmousewheel),f.railh&&f.bind(f.railh,"mousewheel",f.onmousewheelhr)),f.ispage||s.cantouch||/HTML|BODY/.test(f.win[0].nodeName)||(f.win.attr("tabindex")||f.win.attr({tabindex:nt++}),f.jqbind(f.win,"focus",function(n){o=f.getTarget(n).id||!0,f.hasfocus=!0,f.canshowonmouseevent&&f.noticeCursor()}),f.jqbind(f.win,"blur",function(){o=!1,f.hasfocus=!1}),f.jqbind(f.win,"mouseenter",function(n){l=f.getTarget(n).id||!0,f.hasmousefocus=!0,f.canshowonmouseevent&&f.noticeCursor()}),f.jqbind(f.win,"mouseleave",function(){l=!1,f.hasmousefocus=!1}))}f.onkeypress=function(n){var i,e,u;if(f.locked&&f.page.maxh==0||(n=n?n:window.e,i=f.getTarget(n),i&&/INPUT|TEXTAREA|SELECT|OPTION/.test(i.nodeName)&&(e=i.getAttribute("type")||i.type||!1,!e||!/submit|button|cancel/i.tp)))return!0;if(f.hasfocus||f.hasmousefocus&&!o||f.ispage&&!o&&!l){if(u=n.keyCode,f.locked&&u!=27)return f.cancelEvent(n);var r=n.ctrlKey||!1,s=n.shiftKey||!1,t=!1;switch(u){case 38:case 63233:f.doScrollBy(72),t=!0;break;case 40:case 63235:f.doScrollBy(-72),t=!0;break;case 37:case 63232:f.railh&&(r?f.doScrollLeft(0):f.doScrollLeftBy(72),t=!0);break;case 39:case 63234:f.railh&&(r?f.doScrollLeft(f.page.maxw):f.doScrollLeftBy(-72),t=!0);break;case 33:case 63276:f.doScrollBy(f.view.h),t=!0;break;case 34:case 63277:f.doScrollBy(-f.view.h),t=!0;break;case 36:case 63273:f.railh&&r?f.doScrollPos(0,0):f.doScrollTo(0),t=!0;break;case 35:case 63275:f.railh&&r?f.doScrollPos(f.page.maxw,f.page.maxh):f.doScrollTo(f.page.maxh),t=!0;break;case 32:f.opt.spacebarenabled&&(s?f.doScrollBy(f.view.h):f.doScrollBy(-f.view.h),t=!0);break;case 27:f.zoomactive&&(f.doZoom(),t=!0)}if(t)return f.cancelEvent(n)}},f.opt.enablekeyboard&&f.bind(document,s.isopera&&!s.isopera12?"keypress":"keydown",f.onkeypress),f.bind(window,"resize",f.lazyResize),f.bind(window,"orientationchange",f.lazyResize),f.bind(window,"load",f.lazyResize),!s.ischrome||f.ispage||f.haswrapper||(tt=f.win.attr("style"),rt=parseFloat(f.win.css("width"))+1,f.win.css("width",rt),f.synched("chromefix",function(){f.win.attr("style",tt)})),f.onAttributeChange=function(){f.lazyResize(250)},f.ispage||f.haswrapper||(h!==!1?(f.observer=new h(function(n){n.forEach(f.onAttributeChange)}),f.observer.observe(f.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),f.observerremover=new h(function(n){n.forEach(function(n){if(n.removedNodes.length>0)for(var t in n.removedNodes)if(n.removedNodes[t]==f.win[0])return f.remove()})}),f.observerremover.observe(f.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(f.bind(f.win,s.isie&&!s.isie9?"propertychange":"DOMAttrModified",f.onAttributeChange),s.isie9&&f.win[0].attachEvent("onpropertychange",f.onAttributeChange),f.bind(f.win,"DOMNodeRemoved",function(n){n.target==f.win[0]&&f.remove()}))),!f.ispage&&f.opt.boxzoom&&f.bind(window,"resize",f.resizeZoom),f.istextarea&&f.bind(f.win,"mouseup",f.lazyResize),f.checkrtlmode=!0,f.lazyResize(30)}if(this.doc[0].nodeName=="IFRAME"){function ut(){var i,u,r;f.iframexd=!1;try{i="contentDocument"in this?this.contentDocument:this.contentWindow.document,u=i.domain}catch(n){f.iframexd=!0,i=!1}if(f.iframexd)return"console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0;f.forcescreen=!0,f.isiframe&&(f.iframe={doc:t(i),html:f.doc.contents().find("html")[0],body:f.doc.contents().find("body")[0]},f.getContentSize=function(){return{w:Math.max(f.iframe.html.scrollWidth,f.iframe.body.scrollWidth),h:Math.max(f.iframe.html.scrollHeight,f.iframe.body.scrollHeight)}},f.docscroll=t(f.iframe.body)),s.isios||!f.opt.iframeautoresize||f.isiframe||(f.win.scrollTop(0),f.doc.height(""),r=Math.max(i.getElementsByTagName("html")[0].scrollHeight,i.body.scrollHeight),f.doc.height(r)),f.lazyResize(30),s.isie7&&f.css(t(f.iframe.html),{"overflow-y":"hidden"}),f.css(t(f.iframe.body),{"overflow-y":"hidden"}),"contentWindow"in this?f.bind(this.contentWindow,"scroll",f.onscroll):f.bind(i,"scroll",f.onscroll),f.opt.enablemousewheel&&f.bind(i,"mousewheel",f.onmousewheel),f.opt.enablekeyboard&&f.bind(i,s.isopera?"keypress":"keydown",f.onkeypress),(s.cantouch||f.opt.touchbehavior)&&(f.bind(i,"mousedown",f.onmousedown),f.bind(i,"mousemove",function(n){f.onmousemove(n,!0)}),f.opt.grabcursorenabled&&s.cursorgrabvalue&&f.css(t(i.body),{cursor:s.cursorgrabvalue})),f.bind(i,"mouseup",f.onmouseup),f.zoom&&(f.opt.dblclickzoom&&f.bind(i,"dblclick",f.doZoom),f.ongesturezoom&&f.bind(i,"gestureend",f.ongesturezoom))}this.doc[0].readyState&&this.doc[0].readyState=="complete"&&setTimeout(function(){ut.call(f.doc[0],!1)},500),f.bind(this.doc,"load",ut)}},this.showCursor=function(n,t){(f.cursortimeout&&(clearTimeout(f.cursortimeout),f.cursortimeout=0),f.rail)&&(f.autohidedom&&(f.autohidedom.stop().css({opacity:f.opt.cursoropacitymax}),f.cursoractive=!0),f.rail.drag&&f.rail.drag.pt==1||(typeof n!="undefined"&&n!==!1&&(f.scroll.y=Math.round(n*1/f.scrollratio.y)),typeof t!="undefined"&&(f.scroll.x=Math.round(t*1/f.scrollratio.x))),f.cursor.css({height:f.cursorheight,top:f.scroll.y}),f.cursorh&&(!f.rail.align&&f.rail.visibility?f.cursorh.css({width:f.cursorwidth,left:f.scroll.x+f.rail.width}):f.cursorh.css({width:f.cursorwidth,left:f.scroll.x}),f.cursoractive=!0),f.zoom&&f.zoom.stop().css({opacity:f.opt.cursoropacitymax}))},this.hideCursor=function(n){f.cursortimeout||f.rail&&f.autohidedom&&(f.cursortimeout=setTimeout(function(){f.rail.active&&f.showonmouseevent||(f.autohidedom.stop().animate({opacity:f.opt.cursoropacitymin}),f.zoom&&f.zoom.stop().animate({opacity:f.opt.cursoropacitymin}),f.cursoractive=!1),f.cursortimeout=0},n||f.opt.hidecursordelay))},this.noticeCursor=function(n,t,i){f.showCursor(t,i),f.rail.active||f.hideCursor(n)},this.getContentSize=f.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:f.haswrapper?function(){return{w:f.doc.outerWidth()+parseInt(f.win.css("paddingLeft"))+parseInt(f.win.css("paddingRight")),h:f.doc.outerHeight()+parseInt(f.win.css("paddingTop"))+parseInt(f.win.css("paddingBottom"))}}:function(){return{w:f.docscroll[0].scrollWidth,h:f.docscroll[0].scrollHeight}},this.onResize=function(n,t){var i,r,u;if(!f.win)return!1;if(!f.haswrapper&&!f.ispage){if(f.win.css("display")=="none")return f.visibility&&f.hideRail().hideRailHr(),!1;f.hidden||f.visibility||f.showRail().showRailHr()}var o=f.page.maxh,e=f.page.maxw,s={h:f.view.h,w:f.view.w};if(f.view={w:f.ispage?f.win.width():parseInt(f.win[0].clientWidth),h:f.ispage?f.win.height():parseInt(f.win[0].clientHeight)},f.page=t?t:f.getContentSize(),f.page.maxh=Math.max(0,f.page.h-f.view.h),f.page.maxw=Math.max(0,f.page.w-f.view.w),f.page.maxh==o&&f.page.maxw==e&&f.view.w==s.w){if(f.ispage||(i=f.win.offset(),f.lastposition&&(r=f.lastposition,r.top==i.top&&r.left==i.left)))return f;f.lastposition=i}return(f.page.maxh==0?(f.hideRail(),f.scrollvaluemax=0,f.scroll.y=0,f.scrollratio.y=0,f.cursorheight=0,f.setScrollTop(0),f.rail.scrollable=!1):f.rail.scrollable=!0,f.page.maxw==0?(f.hideRailHr(),f.scrollvaluemaxw=0,f.scroll.x=0,f.scrollratio.x=0,f.cursorwidth=0,f.setScrollLeft(0),f.railh.scrollable=!1):f.railh.scrollable=!0,f.locked=f.page.maxh==0&&f.page.maxw==0,f.locked)?(f.ispage||f.updateScrollBar(f.view),!1):(f.hidden||f.visibility?f.hidden||f.railh.visibility||f.showRailHr():f.showRail().showRailHr(),f.istextarea&&f.win.css("resize")&&f.win.css("resize")!="none"&&(f.view.h-=20),f.cursorheight=Math.min(f.view.h,Math.round(f.view.h*(f.view.h/f.page.h))),f.cursorheight=f.opt.cursorfixedheight?f.opt.cursorfixedheight:Math.max(f.opt.cursorminheight,f.cursorheight),f.cursorwidth=Math.min(f.view.w,Math.round(f.view.w*(f.view.w/f.page.w))),f.cursorwidth=f.opt.cursorfixedheight?f.opt.cursorfixedheight:Math.max(f.opt.cursorminheight,f.cursorwidth),f.scrollvaluemax=f.view.h-f.cursorheight-f.cursor.hborder,f.railh&&(f.railh.width=f.page.maxh>0?f.view.w-f.rail.width:f.view.w,f.scrollvaluemaxw=f.railh.width-f.cursorwidth-f.cursorh.wborder),f.checkrtlmode&&f.railh&&(f.checkrtlmode=!1,f.opt.rtlmode&&f.scroll.x==0&&f.setScrollLeft(f.page.maxw)),f.ispage||f.updateScrollBar(f.view),f.scrollratio={x:f.page.maxw/f.scrollvaluemaxw,y:f.page.maxh/f.scrollvaluemax},u=f.getScrollTop(),u>f.page.maxh?f.doScrollTop(f.page.maxh):(f.scroll.y=Math.round(f.getScrollTop()*(1/f.scrollratio.y)),f.scroll.x=Math.round(f.getScrollLeft()*(1/f.scrollratio.x)),f.cursoractive&&f.noticeCursor()),f.scroll.y&&f.getScrollTop()==0&&f.doScrollTo(Math.floor(f.scroll.y*f.scrollratio.y)),f)},this.resize=f.onResize,this.lazyResize=function(n){return n=isNaN(n)?30:n,f.delayed("resize",f.resize,n),f},this._bind=function(n,t,i,r){f.events.push({e:n,n:t,f:i,b:r,q:!1}),n.addEventListener?n.addEventListener(t,i,r||!1):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i},this.jqbind=function(n,i,r){f.events.push({e:n,n:i,f:r,q:!0}),t(n).bind(i,r)},this.bind=function(n,t,i,r){var u="jquery"in n?n[0]:n,e,o;t=="mousewheel"?"onwheel"in f.win?f._bind(u,"wheel",i,r||!1):(e=typeof document.onmousewheel!="undefined"?"mousewheel":"DOMMouseScroll",w(u,e,i,r||!1),e=="DOMMouseScroll"&&w(u,"MozMousePixelScroll",i,r||!1)):u.addEventListener?(s.cantouch&&/mouseup|mousedown|mousemove/.test(t)&&(o=t=="mousedown"?"touchstart":t=="mouseup"?"touchend":"touchmove",f._bind(u,o,function(n){var t;n.touches?n.touches.length<2&&(t=n.touches.length?n.touches[0]:n,t.original=n,i.call(this,t)):n.changedTouches&&(t=n.changedTouches[0],t.original=n,i.call(this,t))},r||!1)),f._bind(u,t,i,r||!1),s.cantouch&&t=="mouseup"&&f._bind(u,"touchcancel",i,r||!1)):f._bind(u,t,function(n){return n=n||window.event||!1,n&&n.srcElement&&(n.target=n.srcElement),"pageY"in n||(n.pageX=n.clientX+document.documentElement.scrollLeft,n.pageY=n.clientY+document.documentElement.scrollTop),i.call(u,n)===!1||r===!1?f.cancelEvent(n):!0})},this._unbind=function(n,t,i,r){n.removeEventListener?n.removeEventListener(t,i,r):n.detachEvent?n.detachEvent("on"+t,i):n["on"+t]=!1},this.unbindAll=function(){for(var n,t=0;t<f.events.length;t++)n=f.events[t],n.q?n.e.unbind(n.n,n.f):f._unbind(n.e,n.n,n.f,n.b)},this.cancelEvent=function(n){var n=n.original?n.original:n?n:window.event||!1;return n?(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.preventManipulation&&n.preventManipulation(),n.cancelBubble=!0,n.cancel=!0,n.returnValue=!1,!1):!1},this.stopPropagation=function(n){var n=n.original?n.original:n?n:window.event||!1;return n?n.stopPropagation?n.stopPropagation():(n.cancelBubble&&(n.cancelBubble=!0),!1):!1},this.showRail=function(){return f.page.maxh!=0&&(f.ispage||f.win.css("display")!="none")&&(f.visibility=!0,f.rail.visibility=!0,f.rail.css("display","block")),f},this.showRailHr=function(){return f.railh?(f.page.maxw!=0&&(f.ispage||f.win.css("display")!="none")&&(f.railh.visibility=!0,f.railh.css("display","block")),f):f},this.hideRail=function(){return f.visibility=!1,f.rail.visibility=!1,f.rail.css("display","none"),f},this.hideRailHr=function(){return f.railh?(f.railh.visibility=!1,f.railh.css("display","none"),f):f},this.show=function(){return f.hidden=!1,f.locked=!1,f.showRail().showRailHr()},this.hide=function(){return f.hidden=!0,f.locked=!0,f.hideRail().hideRailHr()},this.toggle=function(){return f.hidden?f.show():f.hide()},this.remove=function(){var i,n,r;for(f.stop(),f.cursortimeout&&clearTimeout(f.cursortimeout),f.doZoomOut(),f.unbindAll(),f.observer!==!1&&f.observer.disconnect(),f.observerremover!==!1&&f.observerremover.disconnect(),f.events=[],f.cursor&&f.cursor.remove(),f.cursorh&&f.cursorh.remove(),f.rail&&f.rail.remove(),f.railh&&f.railh.remove(),f.zoom&&f.zoom.remove(),i=0;i<f.saved.css.length;i++)n=f.saved.css[i],n[0].css(n[1],typeof n[2]=="undefined"?"":n[2]);f.saved=!1,f.me.data("__nicescroll",""),t.nicescroll.remove(f);for(r in f)f[r]=null,delete f[r];f=null},this.scrollstart=function(n){return this.onscrollstart=n,f},this.scrollend=function(n){return this.onscrollend=n,f},this.scrollcancel=function(n){return this.onscrollcancel=n,f},this.zoomin=function(n){return this.onzoomin=n,f},this.zoomout=function(n){return this.onzoomout=n,f},this.isScrollable=function(n){var i=n.target?n.target:n,r,u;if(i.nodeName=="OPTION")return!0;while(i&&i.nodeType==1&&!/BODY|HTML/.test(i.nodeName)){if(r=t(i),u=r.css("overflowY")||r.css("overflowX")||r.css("overflow")||"",/scroll|auto/.test(u))return i.clientHeight!=i.scrollHeight;i=i.parentNode?i.parentNode:!1}return!1},this.getViewport=function(n){for(var i=n&&n.parentNode?n.parentNode:!1,r,u;i&&i.nodeType==1&&!/BODY|HTML/.test(i.nodeName);){if((r=t(i),u=r.css("overflowY")||r.css("overflowX")||r.css("overflow")||"",/scroll|auto/.test(u)&&i.clientHeight!=i.scrollHeight)||r.getNiceScroll().length>0)return r;i=i.parentNode?i.parentNode:!1}return!1},this.onmousewheel=function(n){var r,i,t;return f.locked?!0:f.rail.drag?f.cancelEvent(n):f.rail.scrollable?(r=+new Date,i=!1,f.opt.preservenativescrolling&&f.checkarea+600<r&&(f.nativescrollingarea=f.isScrollable(n),i=!0),f.checkarea=r,f.nativescrollingarea)?!0:(t=p(n,!1,i),t&&(f.checkarea=0),t):f.railh&&f.railh.scrollable?f.onmousewheelhr(n):!0},this.onmousewheelhr=function(n){if(f.locked||!f.railh.scrollable)return!0;if(f.rail.drag)return f.cancelEvent(n);var i=+new Date,t=!1;return(f.opt.preservenativescrolling&&f.checkarea+600<i&&(f.nativescrollingarea=f.isScrollable(n),t=!0),f.checkarea=i,f.nativescrollingarea)?!0:f.locked?f.cancelEvent(n):p(n,!0,t)},this.stop=function(){return f.cancelScroll(),f.scrollmon&&f.scrollmon.stop(),f.cursorfreezed=!1,f.scroll.y=Math.round(f.getScrollTop()*(1/f.scrollratio.y)),f.noticeCursor(),f},this.getTransitionSpeed=function(n){var i=Math.round(f.opt.scrollspeed*10),t=Math.min(i,Math.round(n/20*f.opt.scrollspeed));return t>20?t:0},f.opt.smoothscroll?f.ishwscroll&&s.hastransition&&f.opt.usetransition?(this.prepareTransition=function(n,t){var r=t?n>20?n:0:f.getTransitionSpeed(n),i=r?s.prefixstyle+"transform "+r+"ms ease-out":"";return f.lasttransitionstyle&&f.lasttransitionstyle==i||(f.lasttransitionstyle=i,f.doc.css(s.transitionstyle,i)),r},this.doScrollLeft=function(n,t){var i=f.scrollrunning?f.newscrolly:f.getScrollTop();f.doScrollPos(n,i,t)},this.doScrollTop=function(n,t){var i=f.scrollrunning?f.newscrollx:f.getScrollLeft();f.doScrollPos(i,n,t)},this.doScrollPos=function(n,t,i){var u=f.getScrollTop(),r=f.getScrollLeft();if((((f.newscrolly-u)*(t-u)<0||(f.newscrollx-r)*(n-r)<0)&&f.cancelScroll(),f.opt.bouncescroll==!1&&(t<0?t=0:t>f.page.maxh&&(t=f.page.maxh),n<0?n=0:n>f.page.maxw&&(n=f.page.maxw)),f.scrollrunning&&n==f.newscrollx&&t==f.newscrolly)||(f.newscrolly=t,f.newscrollx=n,f.newscrollspeed=i||!1,f.timer))return!1;f.timer=setTimeout(function(){var u=f.getScrollTop(),e=f.getScrollLeft(),r={},c,i,l,o,h;r.x=n-e,r.y=t-u,r.px=e,r.py=u,c=Math.round(Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))),i=f.newscrollspeed&&f.newscrollspeed>1?f.newscrollspeed:f.getTransitionSpeed(c),f.newscrollspeed&&f.newscrollspeed<=1&&(i*=f.newscrollspeed),f.prepareTransition(i,!0),f.timerscroll&&f.timerscroll.tm&&clearInterval(f.timerscroll.tm),i>0&&(!f.scrollrunning&&f.onscrollstart&&(l={type:"scrollstart",current:{x:e,y:u},request:{x:n,y:t},end:{x:f.newscrollx,y:f.newscrolly},speed:i},f.onscrollstart.call(f,l)),s.transitionend?f.scrollendtrapped||(f.scrollendtrapped=!0,f.bind(f.doc,s.transitionend,f.onScrollEnd,!1)):(f.scrollendtrapped&&clearTimeout(f.scrollendtrapped),f.scrollendtrapped=setTimeout(f.onScrollEnd,i)),o=u,h=e,f.timerscroll={bz:new BezierClass(o,f.newscrolly,i,0,0,.58,1),bh:new BezierClass(h,f.newscrollx,i,0,0,.58,1)},f.cursorfreezed||(f.timerscroll.tm=setInterval(function(){f.showCursor(f.getScrollTop(),f.getScrollLeft())},60))),f.synched("doScroll-set",function(){f.timer=0,f.scrollendtrapped&&(f.scrollrunning=!0),f.setScrollTop(f.newscrolly),f.setScrollLeft(f.newscrollx),f.scrollendtrapped||f.onScrollEnd()})},50)},this.cancelScroll=function(){if(!f.scrollendtrapped)return!0;var t=f.getScrollTop(),n=f.getScrollLeft();return f.scrollrunning=!1,s.transitionend||clearTimeout(s.transitionend),f.scrollendtrapped=!1,f._unbind(f.doc,s.transitionend,f.onScrollEnd),f.prepareTransition(0),f.setScrollTop(t),f.railh&&f.setScrollLeft(n),f.timerscroll&&f.timerscroll.tm&&clearInterval(f.timerscroll.tm),f.timerscroll=!1,f.cursorfreezed=!1,f.showCursor(t,n),f},this.onScrollEnd=function(){var t,n,i;if(f.scrollendtrapped&&f._unbind(f.doc,s.transitionend,f.onScrollEnd),f.scrollendtrapped=!1,f.prepareTransition(0),f.timerscroll&&f.timerscroll.tm&&clearInterval(f.timerscroll.tm),f.timerscroll=!1,t=f.getScrollTop(),n=f.getScrollLeft(),f.setScrollTop(t),f.railh&&f.setScrollLeft(n),f.noticeCursor(!1,t,n),f.cursorfreezed=!1,t<0?t=0:t>f.page.maxh&&(t=f.page.maxh),n<0?n=0:n>f.page.maxw&&(n=f.page.maxw),t!=f.newscrolly||n!=f.newscrollx)return f.doScrollPos(n,t,f.opt.snapbackspeed);f.onscrollend&&f.scrollrunning&&(i={type:"scrollend",current:{x:n,y:t},end:{x:f.newscrollx,y:f.newscrolly}},f.onscrollend.call(f,i)),f.scrollrunning=!1}):(this.doScrollLeft=function(n,t){var i=f.scrollrunning?f.newscrolly:f.getScrollTop();f.doScrollPos(n,i,t)},this.doScrollTop=function(n,t){var i=f.scrollrunning?f.newscrollx:f.getScrollLeft();f.doScrollPos(i,n,t)},this.doScrollPos=function(n,t,u){function v(){var u,n,t,i,e;if(f.cancelAnimationFrame)return!0;if(f.scrollrunning=!0,l=1-l,l)return f.timer=r(v)||1;u=0,n=sy=f.getScrollTop(),f.dst.ay?(n=f.bzscroll?f.dst.py+f.bzscroll.getNow()*f.dst.ay:f.newscrolly,i=n-sy,(i<0&&n<f.newscrolly||i>0&&n>f.newscrolly)&&(n=f.newscrolly),f.setScrollTop(n),n==f.newscrolly&&(u=1)):u=1,t=sx=f.getScrollLeft(),f.dst.ax?(t=f.bzscroll?f.dst.px+f.bzscroll.getNow()*f.dst.ax:f.newscrollx,i=t-sx,(i<0&&t<f.newscrollx||i>0&&t>f.newscrollx)&&(t=f.newscrollx),f.setScrollLeft(t),t==f.newscrollx&&(u+=1)):u+=1,u==2?(f.timer=0,f.cursorfreezed=!1,f.bzscroll=!1,f.scrollrunning=!1,n<0?n=0:n>f.page.maxh&&(n=f.page.maxh),t<0?t=0:t>f.page.maxw&&(t=f.page.maxw),t!=f.newscrollx||n!=f.newscrolly?f.doScrollPos(t,n):f.onscrollend&&(e={type:"scrollend",current:{x:sx,y:sy},end:{x:f.newscrollx,y:f.newscrolly}},f.onscrollend.call(f,e))):f.timer=r(v)||1}var t=typeof t=="undefined"||t===!1?f.getScrollTop(!0):t,o,e,c,a,h,s,l,y;if(f.timer&&f.newscrolly==t&&f.newscrollx==n)return!0;(f.timer&&i(f.timer),f.timer=0,o=f.getScrollTop(),e=f.getScrollLeft(),((f.newscrolly-o)*(t-o)<0||(f.newscrollx-e)*(n-e)<0)&&f.cancelScroll(),f.newscrolly=t,f.newscrollx=n,f.bouncescroll&&f.rail.visibility||(f.newscrolly<0?f.newscrolly=0:f.newscrolly>f.page.maxh&&(f.newscrolly=f.page.maxh)),f.bouncescroll&&f.railh.visibility||(f.newscrollx<0?f.newscrollx=0:f.newscrollx>f.page.maxw&&(f.newscrollx=f.page.maxw)),f.dst={},f.dst.x=n-e,f.dst.y=t-o,f.dst.px=e,f.dst.py=o,c=Math.round(Math.sqrt(Math.pow(f.dst.x,2)+Math.pow(f.dst.y,2))),f.dst.ax=f.dst.x/c,f.dst.ay=f.dst.y/c,a=0,h=c,f.dst.x==0?(a=o,h=t,f.dst.ay=1,f.dst.py=0):f.dst.y==0&&(a=e,h=n,f.dst.ax=1,f.dst.px=0),s=f.getTransitionSpeed(c),u&&u<=1&&(s*=u),f.bzscroll=s>0?f.bzscroll?f.bzscroll.update(h,s):new BezierClass(a,h,s,0,1,0,1):!1,f.timer)||((o==f.page.maxh&&t>=f.page.maxh||e==f.page.maxw&&n>=f.page.maxw)&&f.checkContentSize(),l=1,f.cancelAnimationFrame=!1,f.timer=1,f.onscrollstart&&!f.scrollrunning&&(y={type:"scrollstart",current:{x:e,y:o},request:{x:n,y:t},end:{x:f.newscrollx,y:f.newscrolly},speed:s},f.onscrollstart.call(f,y)),v(),(o==f.page.maxh&&t>=o||e==f.page.maxw&&n>=e)&&f.checkContentSize(),f.noticeCursor())},this.cancelScroll=function(){return f.timer&&i(f.timer),f.timer=0,f.bzscroll=!1,f.scrollrunning=!1,f}):(this.doScrollLeft=function(n,t){var i=f.getScrollTop();f.doScrollPos(n,i,t)},this.doScrollTop=function(n,t){var i=f.getScrollLeft();f.doScrollPos(i,n,t)},this.doScrollPos=function(n,t){var u=n>f.page.maxw?f.page.maxw:n,r;u<0&&(u=0),r=t>f.page.maxh?f.page.maxh:t,r<0&&(r=0),f.synched("scroll",function(){f.setScrollTop(r),f.setScrollLeft(u)})},this.cancelScroll=function(){}),this.doScrollBy=function(n,t){var i=0,u,r;if(t?i=Math.floor((f.scroll.y-n)*f.scrollratio.y):(u=f.timer?f.newscrolly:f.getScrollTop(!0),i=u-n),f.bouncescroll&&(r=Math.round(f.view.h/2),i<-r?i=-r:i>f.page.maxh+r&&(i=f.page.maxh+r)),f.cursorfreezed=!1,py=f.getScrollTop(!0),i<0&&py<=0)return f.noticeCursor();if(i>f.page.maxh&&py>=f.page.maxh)return f.checkContentSize(),f.noticeCursor();f.doScrollTop(i)},this.doScrollLeftBy=function(n,t){var i=0,u,r;if((t?i=Math.floor((f.scroll.x-n)*f.scrollratio.x):(u=f.timer?f.newscrollx:f.getScrollLeft(!0),i=u-n),f.bouncescroll&&(r=Math.round(f.view.w/2),i<-r?i=-r:i>f.page.maxw+r&&(i=f.page.maxw+r)),f.cursorfreezed=!1,px=f.getScrollLeft(!0),i<0&&px<=0)||i>f.page.maxw&&px>=f.page.maxw)return f.noticeCursor();f.doScrollLeft(i)},this.doScrollTo=function(n,t){var i=t?Math.round(n*f.scrollratio.y):n;i<0?i=0:i>f.page.maxh&&(i=f.page.maxh),f.cursorfreezed=!1,f.doScrollTop(n)},this.checkContentSize=function(){var n=f.getContentSize();(n.h!=f.page.h||n.w!=f.page.w)&&f.resize(!1,n)},f.onscroll=function(){f.rail.drag||f.cursorfreezed||f.synched("scroll",function(){f.scroll.y=Math.round(f.getScrollTop()*(1/f.scrollratio.y)),f.railh&&(f.scroll.x=Math.round(f.getScrollLeft()*(1/f.scrollratio.x))),f.noticeCursor()})},f.bind(f.docscroll,"scroll",f.onscroll),this.doZoomIn=function(n){var u,o,h,i,r;if(!f.zoomactive){f.zoomactive=!0,f.zoomrestore={style:{}},u=["position","top","left","zIndex","backgroundColor","marginTop","marginBottom","marginLeft","marginRight"],o=f.win[0].style;for(h in u)i=u[h],f.zoomrestore.style[i]=typeof o[i]!="undefined"?o[i]:"";return f.zoomrestore.style.width=f.win.css("width"),f.zoomrestore.style.height=f.win.css("height"),f.zoomrestore.padding={w:f.win.outerWidth()-f.win.width(),h:f.win.outerHeight()-f.win.height()},s.isios4&&(f.zoomrestore.scrollTop=t(window).scrollTop(),t(window).scrollTop(0)),f.win.css({position:s.isios4?"absolute":"fixed",top:0,left:0,"z-index":e+100,margin:"0px"}),r=f.win.css("backgroundColor"),(r==""||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(r))&&f.win.css("backgroundColor","#fff"),f.rail.css({"z-index":e+101}),f.zoom.css({"z-index":e+102}),f.zoom.css("backgroundPosition","0px -18px"),f.resizeZoom(),f.onzoomin&&f.onzoomin.call(f),f.cancelEvent(n)}},this.doZoomOut=function(n){if(f.zoomactive)return f.zoomactive=!1,f.win.css("margin",""),f.win.css(f.zoomrestore.style),s.isios4&&t(window).scrollTop(f.zoomrestore.scrollTop),f.rail.css({"z-index":f.zindex}),f.zoom.css({"z-index":f.zindex}),f.zoomrestore=!1,f.zoom.css("backgroundPosition","0px 0px"),f.onResize(),f.onzoomout&&f.onzoomout.call(f),f.cancelEvent(n)},this.doZoom=function(n){return f.zoomactive?f.doZoomOut(n):f.doZoomIn(n)},this.resizeZoom=function(){if(f.zoomactive){var n=f.getScrollTop();f.win.css({width:t(window).width()-f.zoomrestore.padding.w+"px",height:t(window).height()-f.zoomrestore.padding.h+"px"}),f.onResize(),f.setScrollTop(Math.min(f.page.maxh,n))}},this.init(),t.nicescroll.push(this)},y=function(n){var t=this;this.nc=n,this.lastx=0,this.lasty=0,this.speedx=0,this.speedy=0,this.lasttime=0,this.steptime=0,this.snapx=!1,this.snapy=!1,this.demulx=0,this.demuly=0,this.lastscrollx=-1,this.lastscrolly=-1,this.chkx=0,this.chky=0,this.timer=0,this.time=function(){return+new Date},this.reset=function(n,i){t.stop();var r=t.time();t.steptime=0,t.lasttime=r,t.speedx=0,t.speedy=0,t.lastx=n,t.lasty=i,t.lastscrollx=-1,t.lastscrolly=-1},this.update=function(n,i){var o=t.time();t.steptime=o-t.lasttime,t.lasttime=o;var e=i-t.lasty,f=n-t.lastx,s=t.nc.getScrollTop(),h=t.nc.getScrollLeft(),r=s+e,u=h+f;t.snapx=u<0||u>t.nc.page.maxw,t.snapy=r<0||r>t.nc.page.maxh,t.speedx=f,t.speedy=e,t.lastx=n,t.lasty=i},this.stop=function(){t.nc.unsynched("domomentum2d"),t.timer&&clearTimeout(t.timer),t.timer=0,t.lastscrollx=-1,t.lastscrolly=-1},this.doSnapy=function(n,i){var r=!1;i<0?(i=0,r=!0):i>t.nc.page.maxh&&(i=t.nc.page.maxh,r=!0),n<0?(n=0,r=!0):n>t.nc.page.maxw&&(n=t.nc.page.maxw,r=!0),r&&t.nc.doScrollPos(n,i,t.nc.opt.snapbackspeed)},this.doMomentum=function(n){var o=t.time(),l=n?o+n:t.lasttime,y=t.nc.getScrollLeft(),v=t.nc.getScrollTop(),s=t.nc.page.maxh,h=t.nc.page.maxw,f,a,p,u,e;if(t.speedx=h>0?Math.min(60,t.speedx):0,t.speedy=s>0?Math.min(60,t.speedy):0,f=l&&o-l<=50,(v<0||v>s||y<0||y>h)&&(f=!1),a=t.speedy&&f?t.speedy:!1,p=t.speedx&&f?t.speedx:!1,a||p){u=Math.max(16,t.steptime),u>50&&(e=u/50,t.speedx*=e,t.speedy*=e,u=50),t.demulxy=0,t.lastscrollx=t.nc.getScrollLeft(),t.chkx=t.lastscrollx,t.lastscrolly=t.nc.getScrollTop(),t.chky=t.lastscrolly;var i=t.lastscrollx,r=t.lastscrolly,c=function(){var n=t.time()-o>600?.04:.02;t.speedx&&(i=Math.floor(t.lastscrollx-t.speedx*(1-t.demulxy)),t.lastscrollx=i,(i<0||i>h)&&(n=.1)),t.speedy&&(r=Math.floor(t.lastscrolly-t.speedy*(1-t.demulxy)),t.lastscrolly=r,(r<0||r>s)&&(n=.1)),t.demulxy=Math.min(1,t.demulxy+n),t.nc.synched("domomentum2d",function(){var u,n;t.speedx&&(u=t.nc.getScrollLeft(),u!=t.chkx&&t.stop(),t.chkx=i,t.nc.setScrollLeft(i)),t.speedy&&(n=t.nc.getScrollTop(),n!=t.chky&&t.stop(),t.chky=r,t.nc.setScrollTop(r)),t.timer||(t.nc.hideCursor(),t.doSnapy(i,r))}),t.demulxy<1?t.timer=setTimeout(c,u):(t.stop(),t.nc.hideCursor(),t.doSnapy(i,r))};c()}else t.doSnapy(t.nc.getScrollLeft(),t.nc.getScrollTop())}},s=n.fn.scrollTop;n.cssHooks.pageYOffset={get:function(n){var u=t.data(n,"__nicescroll")||!1;return u&&u.ishwscroll?u.getScrollTop():s.call(n)},set:function(n,i){var r=t.data(n,"__nicescroll")||!1;return r&&r.ishwscroll?r.setScrollTop(parseInt(i)):s.call(n,i),this}},n.fn.scrollTop=function(n){if(typeof n=="undefined"){var i=this[0]?t.data(this[0],"__nicescroll")||!1:!1;return i&&i.ishwscroll?i.getScrollTop():s.call(this)}return this.each(function(){var i=t.data(this,"__nicescroll")||!1;i&&i.ishwscroll?i.setScrollTop(parseInt(n)):s.call(t(this),n)})},u=n.fn.scrollLeft,t.cssHooks.pageXOffset={get:function(n){var f=t.data(n,"__nicescroll")||!1;return f&&f.ishwscroll?f.getScrollLeft():u.call(n)},set:function(n,i){var r=t.data(n,"__nicescroll")||!1;return r&&r.ishwscroll?r.setScrollLeft(parseInt(i)):u.call(n,i),this}},n.fn.scrollLeft=function(n){if(typeof n=="undefined"){var i=this[0]?t.data(this[0],"__nicescroll")||!1:!1;return i&&i.ishwscroll?i.getScrollLeft():u.call(this)}return this.each(function(){var i=t.data(this,"__nicescroll")||!1;i&&i.ishwscroll?i.setScrollLeft(parseInt(n)):u.call(t(this),n)})},f=function(n){var i=this,r;if(this.length=0,this.name="nicescrollarray",this.each=function(n){for(var r=0,t=0;t<i.length;t++)n.call(i[t],r++);return i},this.push=function(n){i[i.length]=n,i.length++},this.remove=function(n){i.each(function(t){this.id===n.id&&(delete i[t],i.length--)})},this.eq=function(n){return i[n]},n)for(a=0;a<n.length;a++)r=t.data(n[a],"__nicescroll")||!1,r&&(this[this.length]=r,this.length++);return this},p(f.prototype,["show","hide","toggle","onResize","resize","remove","stop","doScrollPos"],function(n,t){n[t]=function(){var n=arguments;return this.each(function(){this[t].apply(this,n)})}}),n.fn.getNiceScroll=function(n){return typeof n=="undefined"?new f(this):t.data(this[n],"__nicescroll")||!1},n.extend(n.expr[":"],{nicescroll:function(n){return t.data(n,"__nicescroll")?!0:!1}}),t.fn.niceScroll=function(n,i){var r,u;return typeof i=="undefined"&&(typeof n!="object"||"jquery"in n||(i=n,n=!1)),r=new f,typeof i=="undefined"&&(i={}),(n||!1)&&(i.doc=t(n),i.win=t(this)),u=!("doc"in i),u||"win"in i||(i.win=t(this)),this.each(function(){var n=t(this).data("__nicescroll")||!1;n||(i.doc=u?t(this):i.doc,n=new w(i,t(this)),t(this).data("__nicescroll",n)),r.push(n)}),r.length==1?r[0]:r},window.NiceScroll={getjQuery:function(){return n}},t.nicescroll||(t.nicescroll=new f,t.nicescroll.options=v)}(jQuery),function(n){"use strict";function it(t){return t&&t.allowPageScroll===undefined&&(t.swipe!==undefined||t.swipeStatus!==undefined)&&(t.allowPageScroll=p),t.click!==undefined&&t.tap===undefined&&(t.tap=t.click),t||(t={}),t=n.extend({},n.fn.swipe.defaults,t),this.each(function(){var r=n(this),i=r.data(f);i||(i=new rt(this,t),r.data(f,i))})}function rt(it,rt){function ir(t){if(!nf()&&!(n(t.target).closest(rt.excludedElements,ft).length>0)){var u=t.originalEvent?t.originalEvent:t,f,e=r?u.touches[0]:u;if(et=b,r?ot=u.touches.length:t.preventDefault(),ht=0,ct=null,yt=null,st=0,kt=0,dt=0,vt=1,pt=0,lt=ku(),gi=dr(),ur(),!r||ot===rt.fingers||rt.fingers===c||ii()?(li(0,e),ki=bt(),ot==2&&(li(1,u.touches[1]),kt=dt=vi(lt[0].start,lt[1].start)),(rt.swipeStatus||rt.pinchStatus)&&(f=at(u,et))):f=!1,f===!1)return et=i,at(u,et),f;oi(!0)}}function nr(n){var u=n.originalEvent?n.originalEvent:n,h,l,f,o,s;et===t||et===i||hr()||(l=r?u.touches[0]:u,f=fr(l),ci=bt(),r&&(ot=u.touches.length),et=e,ot==2&&(kt==0?(li(1,u.touches[1]),kt=dt=vi(lt[0].start,lt[1].start)):(fr(u.touches[1]),dt=vi(lt[0].end,lt[1].end),yt=eu(lt[0].end,lt[1].end)),vt=fu(kt,dt),pt=Math.abs(kt-dt)),ot===rt.fingers||rt.fingers===c||!r||ii()?(ct=tu(f.start,f.end),gr(n,ct),ht=ou(f.start,f.end),st=sr(),su(ct,ht),(rt.swipeStatus||rt.pinchStatus)&&(h=at(u,et)),(!rt.triggerOnTouchEnd||rt.triggerOnTouchLeave)&&(o=!0,rt.triggerOnTouchLeave&&(s=iu(this),o=ru(f.end,s)),!rt.triggerOnTouchEnd&&o?et=pi(e):rt.triggerOnTouchLeave&&!o&&(et=pi(t)),(et==i||et==t)&&at(u,et))):(et=i,at(u,et)),h===!1&&(et=i,at(u,et)))}function rr(n){var u=n.originalEvent;if(r&&u.touches.length>0)return du(),!0;hr()&&(ot=bi),n.preventDefault(),ci=bt(),st=sr(),ai()?(et=i,at(u,et)):rt.triggerOnTouchEnd||rt.triggerOnTouchEnd==!1&&et===e?(et=t,at(u,et)):!rt.triggerOnTouchEnd&&cr()?(et=t,ni(u,et,w)):et===e&&(et=i,at(u,et)),oi(!1)}function gt(){ot=0,ci=0,ki=0,kt=0,dt=0,vt=1,ur(),oi(!1)}function tr(n){var i=n.originalEvent;rt.triggerOnTouchLeave&&(et=pi(t),at(i,et))}function kr(){ft.unbind(ri,ir),ft.unbind(si,gt),ft.unbind(wi,nr),ft.unbind(di,rr),ti&&ft.unbind(ti,tr),oi(!1)}function pi(n){var r=n,o=lr(),u=yr(),f=ai();return!o||f?r=i:u&&n==e&&(!rt.triggerOnTouchEnd||rt.triggerOnTouchLeave)?r=t:!u&&n==t&&rt.triggerOnTouchLeave&&(r=i),r}function at(n,u){var f=undefined;return gu()||pr()?f=ni(n,u,nt):(wu()||ii())&&f!==!1&&(f=ni(n,u,k)),lu()&&f!==!1?f=ni(n,u,g):pu()&&f!==!1?f=ni(n,u,tt):cu()&&f!==!1&&(f=ni(n,u,w)),u===i&&gt(n),u===t&&(r?n.touches.length==0&&gt(n):gt(n)),f}function ni(r,f,e){var c=undefined;if(e==nt){if(ft.trigger("swipeStatus",[f,ct||null,ht||0,st||0,ot]),rt.swipeStatus&&(c=rt.swipeStatus.call(ft,r,f,ct||null,ht||0,st||0,ot),c===!1))return!1;if(f==t&&vr()){if(ft.trigger("swipe",[ct,ht,st,ot]),rt.swipe&&(c=rt.swipe.call(ft,r,ct,ht,st,ot),c===!1))return!1;switch(ct){case u:ft.trigger("swipeLeft",[ct,ht,st,ot]),rt.swipeLeft&&(c=rt.swipeLeft.call(ft,r,ct,ht,st,ot));break;case o:ft.trigger("swipeRight",[ct,ht,st,ot]),rt.swipeRight&&(c=rt.swipeRight.call(ft,r,ct,ht,st,ot));break;case h:ft.trigger("swipeUp",[ct,ht,st,ot]),rt.swipeUp&&(c=rt.swipeUp.call(ft,r,ct,ht,st,ot));break;case s:ft.trigger("swipeDown",[ct,ht,st,ot]),rt.swipeDown&&(c=rt.swipeDown.call(ft,r,ct,ht,st,ot))}}}if(e==k){if(ft.trigger("pinchStatus",[f,yt||null,pt||0,st||0,ot,vt]),rt.pinchStatus&&(c=rt.pinchStatus.call(ft,r,f,yt||null,pt||0,st||0,ot,vt),c===!1))return!1;if(f==t&&ar())switch(yt){case v:ft.trigger("pinchIn",[yt||null,pt||0,st||0,ot,vt]),rt.pinchIn&&(c=rt.pinchIn.call(ft,r,yt||null,pt||0,st||0,ot,vt));break;case y:ft.trigger("pinchOut",[yt||null,pt||0,st||0,ot,vt]),rt.pinchOut&&(c=rt.pinchOut.call(ft,r,yt||null,pt||0,st||0,ot,vt))}}return e==w?(f===i||f===t)&&(clearTimeout(ui),yi()&&!vu()?(wt=bt(),ui=setTimeout(n.proxy(function(){wt=null,ft.trigger("tap",[r.target]),rt.tap&&(c=rt.tap.call(ft,r,r.target))},this),rt.doubleTapThreshold)):(wt=null,ft.trigger("tap",[r.target]),rt.tap&&(c=rt.tap.call(ft,r,r.target)))):e==g?(f===i||f===t)&&(clearTimeout(ui),wt=null,ft.trigger("doubletap",[r.target]),rt.doubleTap&&(c=rt.doubleTap.call(ft,r,r.target))):e==tt&&(f===i||f===t)&&(clearTimeout(ui),wt=null,ft.trigger("longtap",[r.target]),rt.longTap&&(c=rt.longTap.call(ft,r,r.target))),c}function yr(){var n=!0;return rt.threshold!==null&&(n=ht>=rt.threshold),n}function ai(){var n=!1;return rt.cancelThreshold!==null&&ct!==null&&(n=or(ct)-ht>=rt.cancelThreshold),n}function nu(){return rt.pinchThreshold!==null?pt>=rt.pinchThreshold:!0}function lr(){var n;return n=rt.maxTimeThreshold?st>=rt.maxTimeThreshold?!1:!0:!0}function gr(n,t){if(rt.allowPageScroll===p||ii())n.preventDefault();else{var i=rt.allowPageScroll===d;switch(t){case u:(rt.swipeLeft&&i||!i&&rt.allowPageScroll!=a)&&n.preventDefault();break;case o:(rt.swipeRight&&i||!i&&rt.allowPageScroll!=a)&&n.preventDefault();break;case h:(rt.swipeUp&&i||!i&&rt.allowPageScroll!=l)&&n.preventDefault();break;case s:(rt.swipeDown&&i||!i&&rt.allowPageScroll!=l)&&n.preventDefault()}}}function ar(){var i=wr(),t=br(),n=nu();return i&&t&&n}function ii(){return!!(rt.pinchStatus||rt.pinchIn||rt.pinchOut)}function wu(){return!!(ar()&&ii())}function vr(){var r=lr(),u=yr(),f=wr(),n=br(),t=ai();return!t&&n&&f&&u&&r}function pr(){return!!(rt.swipe||rt.swipeStatus||rt.swipeLeft||rt.swipeRight||rt.swipeUp||rt.swipeDown)}function gu(){return!!(vr()&&pr())}function wr(){return ot===rt.fingers||rt.fingers===c||!r}function br(){return lt[0].end.x!==0}function cr(){return!!rt.tap}function yi(){return!!rt.doubleTap}function au(){return!!rt.longTap}function er(){if(wt==null)return!1;var n=bt();return yi()&&n-wt<=rt.doubleTapThreshold}function vu(){return er()}function yu(){return(ot===1||!r)&&(isNaN(ht)||ht===0)}function hu(){return st>rt.longTapThreshold&&ht<ut}function cu(){return!!(yu()&&cr())}function lu(){return!!(er()&&yi())}function pu(){return!!(hu()&&au())}function du(){hi=bt(),bi=event.touches.length+1}function ur(){hi=0,bi=0}function hr(){var t=!1,n;return hi&&(n=bt()-hi,n<=rt.fingerReleaseThreshold&&(t=!0)),t}function nf(){return!!(ft.data(f+"_intouch")===!0)}function oi(n){n===!0?(ft.bind(wi,nr),ft.bind(di,rr),ti&&ft.bind(ti,tr)):(ft.unbind(wi,nr,!1),ft.unbind(di,rr,!1),ti&&ft.unbind(ti,tr,!1)),ft.data(f+"_intouch",n===!0)}function li(n,t){var i=t.identifier!==undefined?t.identifier:0;return lt[n].identifier=i,lt[n].start.x=lt[n].end.x=t.pageX||t.clientX,lt[n].start.y=lt[n].end.y=t.pageY||t.clientY,lt[n]}function fr(n){var i=n.identifier!==undefined?n.identifier:0,t=bu(i);return t.end.x=n.pageX||n.clientX,t.end.y=n.pageY||n.clientY,t}function bu(n){for(var t=0;t<lt.length;t++)if(lt[t].identifier==n)return lt[t]}function ku(){for(var t=[],n=0;n<=5;n++)t.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return t}function su(n,t){t=Math.max(t,or(n)),gi[n].distance=t}function or(n){return gi[n].distance}function dr(){var n={};return n[u]=ei(u),n[o]=ei(o),n[h]=ei(h),n[s]=ei(s),n}function ei(n){return{direction:n,distance:0}}function sr(){return ci-ki}function vi(n,t){var r=Math.abs(n.x-t.x),i=Math.abs(n.y-t.y);return Math.round(Math.sqrt(r*r+i*i))}function fu(n,t){var i=t/n*1;return i.toFixed(2)}function eu(){return vt<1?y:v}function ou(n,t){return Math.round(Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)))}function uu(n,t){var r=n.x-t.x,f=t.y-n.y,u=Math.atan2(f,r),i=Math.round(u*180/Math.PI);return i<0&&(i=360-Math.abs(i)),i}function tu(n,t){var i=uu(n,t);return i<=45&&i>=0?u:i<=360&&i>=315?u:i>=135&&i<=225?o:i>45&&i<135?s:h}function bt(){var n=new Date;return n.getTime()}function iu(t){t=n(t);var i=t.offset();return{left:i.left,right:i.left+t.outerWidth(),top:i.top,bottom:i.top+t.outerHeight()}}function ru(n,t){return n.x>t.left&&n.x<t.right&&n.y>t.top&&n.y<t.bottom}var fi=r||!rt.fallbackToMouseEvents,ri=fi?"touchstart":"mousedown",wi=fi?"touchmove":"mousemove",di=fi?"touchend":"mouseup",ti=fi?null:"mouseleave",si="touchcancel",ht=0,ct=null,st=0,kt=0,dt=0,vt=1,pt=0,yt=0,gi=null,ft=n(it),et="start",ot=0,lt=null,ki=0,ci=0,hi=0,bi=0,wt=0,ui=null;try{ft.bind(ri,ir),ft.bind(si,gt)}catch(tf){n.error("events not supported "+ri+","+si+" on jQuery.swipe")}this.enable=function(){return ft.bind(ri,ir),ft.bind(si,gt),ft},this.disable=function(){return kr(),ft},this.destroy=function(){return kr(),ft.data(f,null),ft},this.option=function(t,i){if(rt[t]!==undefined){if(i===undefined)return rt[t];rt[t]=i}else n.error("Option "+t+" does not exist on jQuery.swipe.options")}}var u="left",o="right",h="up",s="down",v="in",y="out",p="none",d="auto",nt="swipe",k="pinch",w="tap",g="doubletap",tt="longtap",a="horizontal",l="vertical",c="all",ut=10,b="start",e="move",t="end",i="cancel",r="ontouchstart"in window,f="TouchSwipe",ft={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};n.fn.swipe=function(t){var r=n(this),i=r.data(f);if(i&&typeof t=="string"){if(i[t])return i[t].apply(this,Array.prototype.slice.call(arguments,1));n.error("Method "+t+" does not exist on jQuery.swipe")}else if(!i&&(typeof t=="object"||!t))return it.apply(this,arguments);return r},n.fn.swipe.defaults=ft,n.fn.swipe.phases={PHASE_START:b,PHASE_MOVE:e,PHASE_END:t,PHASE_CANCEL:i},n.fn.swipe.directions={LEFT:u,RIGHT:o,UP:h,DOWN:s,IN:v,OUT:y},n.fn.swipe.pageScroll={NONE:p,HORIZONTAL:a,VERTICAL:l,AUTO:d},n.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:c}}(jQuery);
/*!
 * jQuery blockUI plugin
 * Version 2.60.0-2013.04.05
 * @requires jQuery v1.7 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2013 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */
(function(){"use strict";function n(n){function l(s,c){var st,ht,p=s==window,l=c&&c.message!==undefined?c.message:undefined,nt,d,k,tt,g,w,b,it,ct,at,et;if(c=n.extend({},n.blockUI.defaults,c||{}),!c.ignoreIfBlocked||!n(s).data("blockUI.isBlocked")){if(c.overlayCSS=n.extend({},n.blockUI.defaults.overlayCSS,c.overlayCSS||{}),st=n.extend({},n.blockUI.defaults.css,c.css||{}),c.onOverlayClick&&(c.overlayCSS.cursor="pointer"),ht=n.extend({},n.blockUI.defaults.themedCSS,c.themedCSS||{}),l=l===undefined?c.message:l,p&&t&&f(window,{fadeOut:0}),l&&typeof l!="string"&&(l.parentNode||l.jquery)&&(nt=l.jquery?l[0]:l,d={},n(s).data("blockUI.history",d),d.el=nt,d.parent=nt.parentNode,d.display=nt.style.display,d.position=nt.style.position,d.parent&&d.parent.removeChild(nt)),n(s).data("blockUI.onUnblock",c.onUnblock),k=c.baseZ,tt=e||c.forceIframe?n('<iframe class="blockUI" style="z-index:'+k+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+c.iframeSrc+'"></iframe>'):n('<div class="blockUI" style="display:none"></div>'),g=c.theme?n('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+k+++';display:none"></div>'):n('<div class="blockUI blockOverlay" style="z-index:'+k+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),c.theme&&p?(b='<div class="blockUI '+c.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(k+10)+';display:none;position:fixed">',c.title&&(b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(c.title||"&nbsp;")+"</div>"),b+='<div class="ui-widget-content ui-dialog-content"></div>',b+="</div>"):c.theme?(b='<div class="blockUI '+c.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(k+10)+';display:none;position:absolute">',c.title&&(b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(c.title||"&nbsp;")+"</div>"),b+='<div class="ui-widget-content ui-dialog-content"></div>',b+="</div>"):b=p?'<div class="blockUI '+c.blockMsgClass+' blockPage" style="z-index:'+(k+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+c.blockMsgClass+' blockElement" style="z-index:'+(k+10)+';display:none;position:absolute"></div>',w=n(b),l&&(c.theme?(w.css(ht),w.addClass("ui-widget-content")):w.css(st)),c.theme||g.css(c.overlayCSS),g.css("position",p?"fixed":"absolute"),(e||c.forceIframe)&&tt.css("opacity",0),it=[tt,g,w],ct=p?n("body"):n(s),n.each(it,function(){this.appendTo(ct)}),c.theme&&c.draggable&&n.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"}),at=y&&(!n.support.boxModel||n("object,embed",p?null:s).length>0),o||at){if(p&&c.allowBodyStretch&&n.support.boxModel&&n("html,body").css("height","100%"),(o||!n.support.boxModel)&&!p)var lt=r(s,"borderTopWidth"),rt=r(s,"borderLeftWidth"),ut=lt?"(0 - "+lt+")":0,ft=rt?"(0 - "+rt+")":0;n.each(it,function(n,t){var i=t[0].style,u,r;i.position="absolute",n<2?(p?i.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+c.quirksmodeOffsetHack+') + "px"'):i.setExpression("height",'this.parentNode.offsetHeight + "px"'),p?i.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):i.setExpression("width",'this.parentNode.offsetWidth + "px"'),ft&&i.setExpression("left",ft),ut&&i.setExpression("top",ut)):c.centerY?(p&&i.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),i.marginTop=0):!c.centerY&&p&&(u=c.css&&c.css.top?parseInt(c.css.top,10):0,r="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+u+') + "px"',i.setExpression("top",r))})}if(l&&(c.theme?w.find(".ui-widget-content").append(l):w.append(l),(l.jquery||l.nodeType)&&n(l).show()),(e||c.forceIframe)&&c.showOverlay&&tt.show(),c.fadeIn){var ot=c.onBlock?c.onBlock:u,vt=c.showOverlay&&!l?ot:u,yt=l?ot:u;c.showOverlay&&g._fadeIn(c.fadeIn,vt),l&&w._fadeIn(c.fadeIn,yt)}else c.showOverlay&&g.show(),l&&w.show(),c.onBlock&&c.onBlock();a(1,s,c),p?(t=w[0],i=n(c.focusableElements,t),c.focusInput&&setTimeout(h,20)):v(w[0],c.centerX,c.centerY),c.timeout&&(et=setTimeout(function(){p?n.unblockUI(c):n(s).unblock(c)},c.timeout),n(s).data("blockUI.timeout",et))}}function f(r,u){var h,s=r==window,e=n(r),l=e.data("blockUI.history"),o=e.data("blockUI.timeout"),f;o&&(clearTimeout(o),e.removeData("blockUI.timeout")),u=n.extend({},n.blockUI.defaults,u||{}),a(0,r,u),u.onUnblock===null&&(u.onUnblock=e.data("blockUI.onUnblock"),e.removeData("blockUI.onUnblock")),f=s?n("body").children().filter(".blockUI").add("body > .blockUI"):e.find(">.blockUI"),u.cursorReset&&(f.length>1&&(f[1].style.cursor=u.cursorReset),f.length>2&&(f[2].style.cursor=u.cursorReset)),s&&(t=i=null),u.fadeOut?(h=f.length,f.fadeOut(u.fadeOut,function(){--h==0&&c(f,l,u,r)})):c(f,l,u,r)}function c(t,i,r,u){var e=n(u);if(t.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),i&&i.el&&(i.el.style.display=i.display,i.el.style.position=i.position,i.parent&&i.parent.appendChild(i.el),e.removeData("blockUI.history")),e.data("blockUI.static")&&e.css("position","static"),typeof r.onUnblock=="function")r.onUnblock(u,r);var f=n(document.body),o=f.width(),s=f[0].style.width;f.width(o-1).width(o),f[0].style.width=s}function a(i,r,u){var e=r==window,o=n(r),f;(i||(!e||t)&&(e||o.data("blockUI.isBlocked")))&&(o.data("blockUI.isBlocked",i),e&&u.bindEvents&&(!i||u.showOverlay))&&(f="mousedown mouseup keydown keypress keyup touchstart touchend touchmove",i?n(document).bind(f,u,s):n(document).unbind(f,s))}function s(r){var u,f;if(r.keyCode&&r.keyCode==9&&t&&r.data.constrainTabKey){var e=i,s=!r.shiftKey&&r.target===e[e.length-1],o=r.shiftKey&&r.target===e[0];if(s||o)return setTimeout(function(){h(o)},10),!1}return(u=r.data,f=n(r.target),f.hasClass("blockOverlay")&&u.onOverlayClick&&u.onOverlayClick(),f.parents("div."+u.blockMsgClass).length>0)?!0:f.parents().children().filter("div.blockUI").length===0}function h(n){if(i){var t=i[n===!0?i.length-1:0];t&&t.focus()}}function v(n,t,i){var u=n.parentNode,o=n.style,e=(u.offsetWidth-n.offsetWidth)/2-r(u,"borderLeftWidth"),f=(u.offsetHeight-n.offsetHeight)/2-r(u,"borderTopWidth");t&&(o.left=e>0?e+"px":"0"),i&&(o.top=f>0?f+"px":"0")}function r(t,i){return parseInt(n.css(t,i),10)||0}var t,i;n.fn._fadeIn=n.fn.fadeIn;var u=n.noop||function(){},e=/MSIE/.test(navigator.userAgent),o=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),p=document.documentMode||0,y=n.isFunction(document.createElement("div").style.setExpression);n.blockUI=function(n){l(window,n)},n.unblockUI=function(n){f(window,n)},n.growlUI=function(t,i,r,u){var f=n('<div class="growlUI"></div>');t&&f.append("<h1>"+t+"</h1>"),i&&f.append("<h2>"+i+"</h2>"),r===undefined&&(r=3e3),n.blockUI({message:f,fadeIn:700,fadeOut:1e3,centerY:!1,timeout:r,showOverlay:!1,onUnblock:u,css:n.blockUI.defaults.growlCSS})},n.fn.block=function(t){if(this[0]===window)return n.blockUI(t),this;var i=n.extend({},n.blockUI.defaults,t||{});return this.each(function(){var t=n(this);i.ignoreIfBlocked&&t.data("blockUI.isBlocked")||t.unblock({fadeOut:0})}),this.each(function(){n.css(this,"position")=="static"&&(this.style.position="relative",n(this).data("blockUI.static",!0)),this.style.zoom=1,l(this,t)})},n.fn.unblock=function(t){return this[0]===window?(n.unblockUI(t),this):this.each(function(){f(this,t)})},n.blockUI.version=2.6,n.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1},t=null,i=[]}typeof define=="function"&&define.amd&&define.amd.jQuery?define(["jquery"],n):n(jQuery)})(),function(n){test(),n.fn.configurator=function(t){function lf(){ie(),ff(),hu(),iu();var n=nf();n.done(function(){li(f)})}function iu(){var r,t;tf(),i.showHotspots||u.find(".show-features").remove(),i.showInspire?(r=n(".inner-wrap").filter(function(){return n(this).data("id")==i.modelId}),r&&(c.append(r.clone().show()),l=c.find(".item"),ft=l.find(".inner"),at=l.find(".outer"),ti=c.find("h1"),bt.removeClass("no-inspire").find(".inspire").show())):bt.addClass("no-inspire").find(".inspire").hide(),i.showBodyStyles&&i.configBodyStyles.convertibleModelId?(t=ri(),u.find(".bodystyle-controls").find("a").text(t).attr("title",t).data("coupe",i.modelId).data("convertible",i.configBodyStyles.convertibleModelId).end().show()):u.find(".bodystyle-controls").hide(),i.isConvertible?(u.find(".roof-controls").show(),u.find(".roof").text(aston.generic.getTranslatedText(i.language,"configurator","roofup"))):u.find(".roof-controls").hide(),i.q?u.addClass("q"):u.removeClass("q")}function tf(){s.get(0).innerHTML=aston.generic.getTranslatedText(i.language,"configurator","exterior"),s.get(1).innerHTML=aston.generic.getTranslatedText(i.language,"configurator","interior"),s.get(2).innerHTML=aston.generic.getTranslatedText(i.language,"configurator","optionsAndAccessories"),s.get(3).innerHTML=aston.generic.getTranslatedText(i.language,"configurator","summary"),s.get(4).innerHTML=aston.generic.getTranslatedText(i.language,"configurator","shareAndSubmit"),tr.text(aston.generic.getTranslatedText(i.language,"configurator","loading")),u.find(".show-features a").text(aston.generic.getTranslatedText(i.language,"configurator","modelFeatures")),u.find(".primary a").text(aston.generic.getTranslatedText(i.language,"configurator","primaryColour")),u.find(".secondary a").text(aston.generic.getTranslatedText(i.language,"configurator","secondaryColour")),w.find("h2").text(aston.generic.getTranslatedText(i.language,"configurator","startupHeading")),w.find("p").text(aston.generic.getTranslatedText(i.language,"configurator","startupText").replace("##VehicleName##",i.modelName)),w.find("#start").text(aston.generic.getTranslatedText(i.language,"configurator","start")),w.find("#load").text(aston.generic.getTranslatedText(i.language,"configurator","load")),n(".terms").text(aston.generic.getTranslatedText(i.language,"configurator","termsAndConditions")),n("#fullRangeLink").text(aston.generic.getTranslatedText(i.language,"configurator","configureFullRange")),u.find(".caveat").text(aston.generic.getTranslatedText(i.language,"configurator","caveat"))}function nf(){var t=n.Deferred(),e=aston.generic.getQueryStringValue("shareId",""),u,r,f;if(e==="")if(u=ef("amlconfigurator"),u)if(r=JSON.parse(u),r&&typeof r.shareId!="undefined"&&r.modelId===i.modelId){w.show();w.find("#load").on("click",function(){var n={guid:r.shareId};return ii(n,t,!0),!1});w.find("#start, .close").on("click",function(){return kr(),w.hide(),t.resolve(),!1})}else t.resolve();else t.resolve();else n(".bodystyle-controls").hide(),f={guid:e},ii(f,t,!1);return t.promise()}function ui(){var n={en:"en",de:"de",zh:"chi",ja:"ja"};return n[i.language]}function ii(n,t,u){var f=kt("retrieve",n);f.done(function(n){n&&(i.q&&(n=n.replace(/;/g,"").replace(/\(|\)/g,""),n=JSON.parse(n)),n.status&&!n.status.contains("error")&&(nr=!0,i.modelId=n.model,r.selection.exterior=n.ext,r.selection.interior=n.int,r.selection.accessories=n.acc.split(","),r.selection.options=n.opt.split(",")),u&&w.hide(),t.resolve())})}function rf(n,t,i){kr(),br(n,t,i)}function br(n,t,i){var u,r;i?(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toGMTString()):u="",document.cookie=n+"="+t+u+"; path=/"}function kr(){br("amlconfigurator","",-1)}function ef(n){for(var u=n+"=",r=document.cookie.split(";"),t,i=0;i<r.length;i++){for(t=r[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(u)==0)return t.substring(u.length,t.length)}return null}function ff(){aston.w.bind("am.configurator.summary.click",function(t,i){var f=_.uniqueId("summary-"),e={id:f},o=n("#zoomTemplate").tmpl(e),r;u.append(o),r=n("#"+f),n.fancybox.open(r,{padding:0,autoSize:!1,beforeLoad:function(){this.width=parseInt(k[aston.theme][0]),this.height=parseInt(k[aston.theme][1])},afterShow:function(){var n=rt(i,b);n.done(function(n){hi(i,n.images,f,ut(b),ot(b))})},afterClose:function(){r.remove()}})}),aston.w.bind("am.configurator.onLoadingStart",function(){ei=!0,u.find(".controls-wrap, .menu-wrap").block({message:"",overlayCSS:{backgroundColor:"#666",opacity:.6,cursor:"default"},fadeIn:0,fadeOut:0,ignoreIfBlocked:!0,focusInput:!1,baseZ:500}),tr.addClass("show")}),aston.w.bind("am.configurator.onLoadingComplete",function(){ei=!1,u.find(".controls-wrap, .menu-wrap").unblock(),tr.removeClass("show")}),aston.w.bind("am.configurator.onViewLoadingStart",function(){cr.show()}),aston.w.bind("am.configurator.onViewLoadingComplete",function(){cr.hide()}),aston.w.bind("am.theme",function(t,r){if(b!==r){if(b=r,n(vi).attr({width:k[r][0],height:k[r][1]}),y=c.width(),i.showInspire)if(yi){var u=l.filter(".on");u.length>0?(u.animate({width:Math.floor(y*.4)},100),l.not(u).animate({width:Math.floor(y*.15)},100)):l.animate({width:Math.floor(y*.2)},100)}else l.animate({width:Math.floor(y*.2)},100);it&&(aston.w.trigger("am.configurator.hotspots.remove"),aston.w.trigger("am.configurator.getData"),hr(),ar())}}),aston.w.bind("am.configurator.onEnvironmentChange",function(n,t){t.parent().hasClass("on")||et(t.data("category"),t)}),aston.w.bind("am.configurator.onPaletteChange",function(n,t,i,r){if(!t.hasClass("true")){var e=t.parents(".scroll-content"),f=e.data("category"),u=t.data("value");wu(i,t),ku(r,f,u),fr(f,u),aston.w.trigger("am.configurator.interiormenu.hide"),aston.w.trigger("am.configurator.getData")}}),aston.w.bind("am.configurator.getData",function(n,t,i,u){aston.w.trigger("am.configurator.onLoadingStart");var e=oi(u);e.done(function(n){var u=si(n);u.done(function(){t?i||(nt.show(),r[f].environments&&r[f].environments[0]&&r[f].environments[0].value?et(r[f].environments[0].value):vt.empty(),pt(!0)):pt(),aston.w.trigger("am.configurator.hotspots.draw"),aston.w.trigger("am.configurator.onLoadingComplete")})})}),aston.w.bind("am.configurator.hideControls",function(){n(".arrows").removeClass("show")}),aston.w.bind("am.configurator.showControls",function(){n(".arrows").addClass("show"),bt.show()}),aston.w.bind("am.configurator.hotspots.draw",function(){var c,u,o,t,n,s;if(i.showHotspots&&ki&&(aston.w.trigger("am.configurator.hotspots.remove"),c={exterior:"E",interior:"I"},r.features.length>0&&(u=_.filter(r.features,function(n){return n.type==c[f]&&n.view==(f==="exterior"?h:e)}),u.length>0))){for(o="",t=0;t<u.length;t++)n=u[t],s='<a href="#" id="'+n.id+'" class="hotspot" title="'+n.title+'" style="top:'+vr(n.y)+"px; left: "+vr(n.x)+'px;"></a>',o+=s;p.append(o)}}),aston.w.bind("am.configurator.hotspots.remove",function(){p.find(".hotspot").remove()}),aston.w.bind("am.configurator.onExteriorAngleChange",function(){aston.w.trigger("am.configurator.getData")}),aston.w.bind("am.configurator.onInteriorAngleChange",function(){aston.w.trigger("am.configurator.getData")}),aston.w.bind("am.configurator.about.click",function(t,i){var o,s,f,e;if(n("body").addClass("gallery-controls"),o=i.data("view"),o!="undefined"&&(s={xlarge:[1e3,667],large:[800,533],medium:[636,424],small:[558,372]},f=_.find(r.views,function(n){return n.intView==o}),f)){var h=_.uniqueId("about-"),c={id:h,title:f.name,text:f.desc,image:f.img||"http://cdn.astonmartin.com/sitefinity/Vantage%20Rebuild/N430/frontdash.jpg"},l=n("#featuresTemplate").tmpl(c);u.append(l),e=n("#"+h),n.fancybox.open(e,{padding:0,autoSize:!1,beforeLoad:function(){this.width=parseInt(s[aston.theme][0]),this.height=parseInt(s[aston.theme][1])},afterClose:function(){e.remove()}})}}),aston.w.bind("am.configurator.hotspot.click",function(t,i){var e;n("body").addClass("gallery-controls");var c=i.attr("id"),h={xlarge:[1e3,667],large:[800,533],medium:[636,424],small:[558,372]},f=_.find(r.features,function(n){return n.id==c});if(f){var s=_.uniqueId("feature-"),o={id:s,title:f.title,text:f.text,image:f.img},l=n("#featuresTemplate").tmpl(o);u.append(l),e=n("#"+s),n.fancybox.open(e,{padding:0,autoSize:!1,beforeLoad:function(){this.width=parseInt(h[aston.theme][0]),this.height=parseInt(h[aston.theme][1]),_.isArray(o.image)&&aston.plugins.carousel.init(e.find(".carousel-wrap"),!0)},afterClose:function(){e.remove()}})}}),aston.w.bind("am.configurator.accessory.click",function(n,t){var o=t.parents(".accessory").find(".selected"),e=t.data("id"),f=t.data("category"),u,s;bi=!0,o.hasClass("on")?(o.removeClass("on"),t.text(aston.generic.getTranslatedText(i.language,"configurator","add")),s=r.selection[f].indexOf(e),r.selection[f].splice(s,1),u=_.find(r[f],function(n){return n.id==e}),u&&(u.selected=!1)):(o.addClass("on"),t.text(aston.generic.getTranslatedText(i.language,"configurator","remove")),r.selection[f].push(e),u=_.find(r[f],function(n){return n.id==e}),u&&(u.selected=!0))}),aston.w.bind("am.configurator.hotspots.show",function(n,t){t.hasClass("on")?(ki=!1,t.removeClass("on"),aston.w.trigger("am.configurator.hotspots.remove")):(ki=!0,t.addClass("on"),aston.w.trigger("am.configurator.hotspots.draw"))}),aston.w.bind("am.configurator.menu.hide",function(n,t){s.not(t).css("visibility","hidden")}),aston.w.bind("am.configurator.menu.show",function(){s.css("visibility","visible");var n=yt();n&&n.text(aston.generic.getTranslatedText(i.language,"configurator","interior"))}),aston.w.bind("am.configurator.interiormenu.show",function(){i.q&&a.addClass("on")}),aston.w.bind("am.configurator.interiormenu.hide",function(){i.q&&a.removeClass("on")}),aston.w.bind("am.configurator.share",function(t,r){var u,f;switch(r){case"facebook":u=window.open("about:blank",aston.ie?"":"Aston Martin","toolbar=0,status=0,width=548,height=325");break;case"twitter":u=window.open("about:blank",aston.ie?"":"Aston Martin","toolbar=0,status=0,width=575,height=440");break;case"linkedin":u=window.open("about:blank",aston.ie?"":"Aston Martin","toolbar=0,status=0,width=520,height=570");break;case"googleplus":u=window.open("about:blank",aston.ie?"":"Aston Martin","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")}f=ci(),f.done(function(t){var f=encodeURIComponent(t.url),l=encodeURIComponent("//az9255.vo.msecnd.net/icons/2d-wings.jpg"),h,s,e,o,c;switch(r){case"facebook":h="http://www.facebook.com/sharer.php?s=100&p[title]=Aston%20Martin%20Configurator&p[url]="+f+"&p[images][0]="+l+"&p[summary]="+i.shareTitle,u.location.replace(h);break;case"twitter":s="http://twitter.com/?status="+f+" via @astonmartin",u.location.replace(s);break;case"linkedin":e="http://www.linkedin.com/shareArticle?mini=true&url="+f+"&title=Aston%20Martin%20Configurator&summary="+i.shareTitle+"&source=Aston%20Martin",u.location.replace(e);break;case"googleplus":o="https://plus.google.com/share?url="+f,u.location.replace(o);break;case"email":window.location="mailto:?subject=Aston Martin Configurator&body="+f;break;case"bitly":n(".bitly-link-value").val(t.url),c=n(".bitly-link-value").val()}})}),aston.w.bind("am.configurator.pdf.generate",function(t,r){pi||(pi=!0,r.find(".text").text(aston.generic.getTranslatedText(i.language,"configurator","generating")),n.when(rt("exterior","small"),rt("interior","small")).done(function(t,u){var f=JSON.stringify({model:i.modelId,ext:t.selection,int:u.selection,acc:lt("accessories"),opt:lt("options"),lang:ui()});n("#pdfLoader")[0].src="/Webservices/ConfiguratorPdfHandler.ashx?json="+f,setTimeout(function(){r.find(".text").text(aston.generic.getTranslatedText(i.language,"configurator","downloadPdf")),pi=!1},2e4)}))}),aston.w.bind("am.configurator.save",function(n,t){t.find(".text").text(aston.generic.getTranslatedText(i.language,"configurator","saving"));var r=ci();r.done(function(n){t.find(".text").text(aston.generic.getTranslatedText(i.language,"configurator","save"));var r=JSON.stringify({modelId:i.modelId,shareId:n.shareId});rf("amlconfigurator",r,30)})})}function uf(t){return n.Deferred(function(n){var i={guid:t};ii(i,n,!1)}).promise()}function ru(){l.css("width",Math.floor(y*.2)).removeClass("on"),ft.hide(),at.show(),ti.show(),n.each(ft,function(t,i){aston.plugins.carousel.stop(n(i).find(".carousel-wrap"))})}function yf(t){return n.Deferred(function(n){ft.not(t).hide(),at.hide(),n.resolve()}).promise()}function fu(t){yi=!1,n(".page").find(".inspire-overlay").remove(),ru(),c.fadeOut("fast"),t.removeClass("on")}function re(t){yi=!0,c.fadeIn("fast",function(){n('<div class="inspire-overlay" />').appendTo(n(".page"))}),t.addClass("on")}function ie(){u.find("#exterior").live("click",function(){return aston.w.trigger("am.configurator.summary.click","exterior"),!1}),u.find("#interior").live("click",function(){return aston.w.trigger("am.configurator.summary.click","interior"),!1});p.on("mousemove",function(n){if(i.q&&f!="exterior"){if(v||g||ei){clearTimeout(d),d=null;return}var t=p.height()/3;n.pageY-u.offset().top<=t?(clearTimeout(d),d=null,aston.w.trigger("am.configurator.interiormenu.show")):n.pageY>=t*1.8&&(d||(d=setTimeout(function(){wr()},750)))}});c.find(".load").live("click",function(){var u=n(this),r=u.data("share"),t=uf(r);return t.done(function(){f=i.defaultView,e=i.defaultViewnum,h=i.defaultRotation,v=!1,g=!1,it=!0,c.fadeOut("fast",function(){ru(),n(".inspire").removeClass("on"),n(".page").find(".inspire-overlay").remove(),n(".menu-wrap .item").removeClass("on"),s.first().click()})}),!1}),c.find(".btn-close").live("click",function(){return fu(n(".inspire")),!1}),n(".inspire").live("click",function(){var t=n(this);return t.hasClass("on")?fu(t):re(t),!1}),c.find(".item").live("click",function(){var t=n(this),i;t.hasClass("on")?t.find(".inner").fadeOut("fast",function(){l.animate({width:Math.floor(y*.2)},300,function(){t.removeClass("on"),ft.hide(),at.show(),ti.fadeIn("fast")})}):(i=yf(t),i.done(function(){ti.fadeOut("fast"),l.not(t).animate({width:Math.floor(y*.15)},300),t.animate({width:Math.floor(y*.4)},300,function(){l.removeClass("on");var n=t.find(".inner");n.fadeIn("fast",function(){n.find(".halfCarousel").hasClass("carousel-built")||aston.plugins.carousel.init(n.find(".carousel-wrap"),!0)}),t.addClass("on")})}))}),u.find(".download-pdf").live("click",function(){return aston.w.trigger("am.configurator.pdf.generate",[n(this)]),!1}),u.find(".show-info").live("click",function(){var t=n(this),u=n(this).parent(".accessory"),r=u.find(".info").first(),i=u.find(".more");return t.hasClass("on")?r.fadeIn("fast",function(){i.fadeOut(),t.removeClass("on")}):i.fadeIn("fast",function(){r.fadeOut(),t.addClass("on")}),!1}),ir||u.find(".canvas-wrap").live({mouseenter:function(){aston.w.trigger("am.configurator.showControls")},mouseleave:function(){aston.w.trigger("am.configurator.hideControls")}}),u.find(".add-accessory").live("click",function(){return aston.w.trigger("am.configurator.accessory.click",[n(this)]),!1}),u.find(".hotspot").live("click",function(){return aston.w.trigger("am.configurator.hotspot.click",[n(this)]),!1}),u.find(".about").live("click",function(){return aston.w.trigger("am.configurator.about.click",[n(this)]),!1});u.find(".model-features").on("click",function(){return aston.w.trigger("am.configurator.hotspots.show",[n(this)]),!1});u.find(".reset").on("click",function(){var t;if(i.q){var r=_.uniqueId("info-"),f={id:r,title:"Reset Your Configuration",text:"<p>Please note resetting your configuration will mean all configured environments are changed to the default colour selection any options you have chosen will be lost.</p><p>If you wish to continue please click proceed.</p>",mode:"reset"},e=n("#infoTemplate").tmpl(f);u.append(e),t=n("#"+r),n.fancybox.open(t,{padding:0,autoSize:!0,beforeLoad:function(){t.find(".yes").on("click",function(){return n.fancybox.close(!0),fi(),!1});t.find(".no").on("click",function(){return n.fancybox.close(!0),!1})},afterClose:function(){t.remove()}})}else fi();return!1});p.swipe({swipe:function(n,t){if(f=="exterior"&&(t==="left"||t==="right")){var e;t==="right"?gt(!1):gt(!0),aston.w.trigger("am.configurator.onExteriorAngleChange")}}});u.find(".arrows").on("click",function(){var c=n(this),h=c.hasClass("right"),r,t,s,o;return f==="exterior"?(h?gt(!1):gt(!0),aston.w.trigger("am.configurator.onExteriorAngleChange")):i.q?(r=u.data("views"),r&&(t=r.indexOf(e),s=r.length,t>-1&&(h?t+1<=s-1&&(o=r[t+1]):t-1>=0&&(o=r[t-1]),_.isNumber(o)&&or(o)))):(vu(),aston.w.trigger("am.configurator.onInteriorAngleChange")),!1});u.find(".environments-wrap").find("a").live("click",function(){return aston.w.trigger("am.configurator.onEnvironmentChange",[n(this)]),!1}),u.find(".controls-wrap").find(".option").live("click",function(){var t=n(this),r=t.parents(".scroll-content").find(".option"),i=n(".current-option");return aston.w.trigger("am.configurator.onPaletteChange",[t,r,i]),!1}),u.find(".colour-palette").find(".option").live("click",function(){var t=n(this),u=t.data("value"),r=t.data("category");return fr(r,u),o("PC"),o("SC"),i.q&&(o("PCE"),o("SCE"),o("PCA"),o("PCS"),o("SCA"),o("SCS")),n.when(st()).done(function(){aston.w.trigger("am.configurator.onLoadingStart");var n=oi();n.done(function(n){var t=si(n);t.done(function(){pt(),et(di),aston.w.trigger("am.configurator.onLoadingComplete"),aston.w.trigger("am.configurator.showControls")})})}),!1}),yr.live("click",function(){var t=n(this),s,i=t.data("category");if(wr(),t.parent().hasClass("on"))st(),t.parent().removeClass("on"),aston.w.trigger("am.configurator.showControls");else{var e=r[f].ui[i],o=_.groupBy(e,function(n){return n.group}),h=_.find(e,function(n){return n.selected=="true"}),u={name:oe(i),text:ee(i),environment:i,palette:o};v||g?n.when(st()).done(function(){sr(u,t)}):(sr(u,t),aston.w.trigger("am.configurator.hideControls"))}return!1}),u.find(".colour-palette").find(".btn-close").live("click",function(){var n=st();return n.done(function(){aston.w.trigger("am.configurator.showControls")}),!1}),u.find(".edit").live("click",function(){var i=n(this),t=i.data("view");return s.filter("[data-view="+t+"]").click(),!1});s.on("click",function(){var t=n(this),r=t.data("view");return t.parent().hasClass("on")?i.q&&f=="interior"&&(t.parent().hasClass("interior-on")?(aston.w.trigger("am.configurator.interiormenu.hide"),t.parent().removeClass("interior-on")):v?n.when(st()).done(function(){aston.w.trigger("am.configurator.interiormenu.show"),t.parent().addClass("interior-on")}):(aston.w.trigger("am.configurator.interiormenu.show"),t.parent().addClass("interior-on"))):(aston.w.trigger("am.configurator.onViewLoadingStart"),aston.w.trigger("am.configurator.menu.hide",[t]),ou.removeClass("on"),t.parent().addClass("on"),r==="exterior"||r==="interior"?(lr(r),li(r),it=!0):(bf(r),it=!1)),!1});u.find(".facebook").live("click",function(){return aston.w.trigger("am.configurator.share",["facebook"]),!1}),u.find(".twitter").live("click",function(){return aston.w.trigger("am.configurator.share",["twitter"]),!1}),u.find(".linkedin").live("click",function(){return aston.w.trigger("am.configurator.share",["linkedin"]),!1}),u.find(".google").live("click",function(){return aston.w.trigger("am.configurator.share",["googleplus"]),!1}),u.find(".share-email").live("click",function(){return aston.w.trigger("am.configurator.share",["email"]),!1}),u.find(".submit").live("click",function(){aston.w.trigger("am.configurator.share",["bitly"])}),u.find(".save-configuration").live("click",function(){return aston.w.trigger("am.configurator.save",[n(this)]),!1});u.find(".roof").on("click",function(){var t=n(this);return wi?(u.find(".roof").text(aston.generic.getTranslatedText(i.language,"configurator","roofup")),r.changed.exterior.rp="down",r.selection.exterior.rp="down",wi=!1):(u.find(".roof").text(aston.generic.getTranslatedText(i.language,"configurator","roofdown")),r.changed.exterior.rp="up",r.selection.exterior.rp="up",wi=!0),f=="interior"&&e!=1&&(e=e==2?3:2),aston.w.trigger("am.configurator.getData"),!1});u.find(".bodystyle").on("click",function(){var f=n(this),e=f.data("coupe"),o=f.data("convertible"),t;return ni?(i.modelId=o,ni=!1,t=ri(),u.find(".bodystyle").text(t).attr("title",t)):(i.modelId=e,ni=!0,t=ri(),u.find(".bodystyle").text(t).attr("title",t)),r.exterior={},r.interior={},r.changed={exterior:{},interior:{}},r.additionalInfo={exterior:!0,interior:!0},n(".menu-wrap .item").removeClass("on"),s.first().click(),!1});a.find(".change").live("click",function(){var t=n(this),i=t.data("view");return clearTimeout(d),d=null,or(i),t.parents("div").first().addClass("on"),!1})}function fi(){r.changed[f]={},r.selection[f]={},aston.w.trigger("am.configurator.onViewLoadingStart"),lr(f),li(f),it=!0}function or(t){var s=_.find(r.views,function(n){return parseInt(n.intView)==t&&n.strArea=="i"}),c=s&&s.bDisplayUI=="0",h=!1,f,u,o;aston.w.trigger("am.configurator.interiormenu.hide"),f=yt(),f&&(f.parent().removeClass("interior-on"),u=aston.generic.getTranslatedText(i.language,"configurator","interior")+" ("+s.name+")",b=="small"&&u=="Interior (Headlining View)"&&(u=u.substring(0,20)+"..."),f.text(u)),a.children().removeClass("on"),o=n(".interior-views").children().find(".change:first").filter(function(){return n(this).data("view")==t}),o&&(o.parents("div").first().addClass("on"),o.parents("div").first().next().addClass("active")),e=t,e>rr&&(rr=e),aston.w.trigger("am.configurator.getData",[!0,c,h])}function wr(){aston.w.trigger("am.configurator.interiormenu.hide");var n=yt();n&&n.parent().removeClass("interior-on")}function ri(){var n=i.configBodyStyles.helperText;return n+=ni?i.configBodyStyles.isVolante?i.configBodyStyles.coupeText:i.configBodyStyles.convertibleText:i.configBodyStyles.isVolante?i.configBodyStyles.convertibleText:i.configBodyStyles.coupeText}function oe(n){var t;switch(n){case"PC":t="Primary Leather Colour Selection";break;case"PCA":t="Primary Alcantara Colour Selection";break;case"PCS":t="Primary Stitch Colour Selection";break;case"PCE":t="Primary Paint Colour Selection";break;case"SCE":t="Secondary Paint Colour Selection";break;case"SC":t="Secondary Leather Colour Selection";break;case"SCA":t="Secondary Alcantara Colour Selection";break;case"SCS":t="Secondary Stitch Colour Selection";break;default:t="Default lorem ipsum dolor sit amet"}return t}function ee(n){var t;if(i.q)switch(n){case"PCE":t="Please select a primary paint colour from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections, only available through the Q by Aston Martin bespoke personalisation service.";break;case"SCE":t="Please select a secondary paint colour from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections, only available through the Q by Aston Martin bespoke personalisation service.";break;case"PCA":t="Please select a primary alcantara colour selection from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections. Please note your configuration will be limited to two alcantara colours (primary and secondary).";break;case"SCA":t="Please select a secondary alcantara colour selection from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections. Please note your configuration will be limited to two alcantara colours (primary and secondary).";break;case"PCS":t="Please select a primary stitch colour selection from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections. Please note your configuration will be limited to two stitch colours (primary and secondary).";break;case"SCS":t="Please select a secondary stitch colour selection from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections. Please note your configuration will be limited to two stitch colours (primary and secondary).";break;case"PC":t="Please select a primary leather colour selection from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections. Please note your configuration will be limited to two leather colours (primary and secondary).";break;case"SC":t="Please select a secondary leather colour selection from the palettes below, either from one of our standard colour collections or our exclusive Q by Aston Martin collections. Please note your configuration will be limited to two leather colours (primary and secondary).";break;default:t="Lorem ipsum dolor sit amet"}else switch(n){case"PC":t=aston.generic.getTranslatedText(i.language,"configurator","primaryColourPaletteText");break;case"SC":t=aston.generic.getTranslatedText(i.language,"configurator","secondaryColourPaletteText")}return t}function lt(n){for(var i="",t=0;t<=r.selection[n].length-1;t++)i+=r.selection[n][t]+",";return i.replace(/\,$/,"")}function fe(){return window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),window.location.href.contains("localhost")?"http://www.astonmartin.com/configure":window.location.origin+window.location.pathname}function ci(){return n.Deferred(function(n){var t=u.data("share");if(!bi&&t&&t!="")n.resolve({url:t});else{var f=fe(),o={model:i.modelId,ext:r.selection.exterior,int:r.selection.interior,acc:lt("accessories"),opt:lt("options")},e=kt("save",o);e.done(function(t){if(t){i.q&&(t=t.replace(/;/g,"").replace(/\(|\)/g,""),t=JSON.parse(t)),f+="?shareId="+t.guid;var e=encodeURIComponent(f),r=aston.generic.getBitlyUrl(e);r.done(function(i){u.data("share",i),n.resolve({url:i,shareId:t.guid})})}})}}).promise()}function bf(t){n(".views-wrap").stop().fadeTo("fast",0,function(){pr.hide();var i;switch(t){case"accessories":i=kf();break;case"summary":i=yu();break;case"share":i=ne()}i.done(function(){bt.hide(),aston.w.trigger("am.configurator.menu.show"),aston.w.trigger("am.configurator.onViewLoadingComplete"),n(".views-wrap").stop().fadeTo("fast",1)})})}function wf(n){n==="exterior"?(e=1,h=i.defaultRotation,v=!1,g=!1):(v=!1,g=!1,i.q&&(e=i.defaultViewnum))}function pf(t){var v,l,y,s,h,b,k,f,d,w,c;if(pr.hide(),n("#stage").show(),t==="exterior"){if(n(".colour-palette").remove(),nt.hide(),p.css("cursor",'url("http://code.vostrel.cz/jquery.reel-drag.cur"),move'),a.hide(),i.q){if(u.find(".arrows").removeClass("interior"),v=_.filter(r.environments.exterior,function(n){return n.navArea=="1"}),v){for(y=v.length,f=0;f<y;f++)s=v[f],s&&(s.colour=ai(s.value,r.selection.interior[s.value]));n("#interiorPaletteTemplate").tmpl(v).appendTo(nt.empty().show())}o("PCE"),o("SCE")}}else if(p.css("cursor","default"),yr.parent().removeClass("on"),n(".colour-palette").remove(),i.removeColourPalette||nt.show(),o("PC"),o("SC"),i.q){if(u.find(".arrows").addClass("interior"),a.show(),aston.w.trigger("am.configurator.interiormenu.show"),l=_.filter(r.environments.interior,function(n){return n.navArea=="1"}),l){for(y=l.length,f=0;f<y;f++)s=l[f],s&&(s.colour=ai(s.value,r.selection.interior[s.value]));n("#interiorPaletteTemplate").tmpl(l).appendTo(nt.empty())}if(a.children().length)a.children().removeClass("on"),d=a.find("img").filter(function(){return n(this).data("view")==e}),d&&d.parent().addClass("on"),o("PCA"),o("PCS"),o("SCA"),o("SCS");else{for(h=_.chain(r.views).filter(function(n){return n.strArea=="i"}).sortBy(function(n){return n.intOrder}).value(),b=_.find(h,function(n){return n.intView==e}),b&&(b.selected=!0),k=[],f=0;f<h.length;f++)k.push(parseInt(h[f].intView)),parseInt(h[f].intOrder)<=rr+1&&(h[f].active=!0);u.data("views",k),af.tmpl(h).appendTo(a)}w=yt(),w&&w.parent().addClass("interior-on");var g=_.uniqueId("info-"),tt={id:g,title:"Interior Configuration Guide",text:"<p>The Q by Aston Martin interior configurator allows you to create your personalised interior specification. You will move through five individual views which only allow you to select specific environment choices, this is to ensure you can focus on set details.</p>",mode:"start"},it=n("#infoTemplate").tmpl(tt);u.append(it),c=n("#"+g),n.fancybox.open(c,{padding:0,autoSize:!0,beforeLoad:function(){c.find(".yes").on("click",function(){return n.fancybox.close(!0),fi(),!1});c.find(".no").on("click",function(){return n.fancybox.close(!0),!1})},afterClose:function(){c.remove()}})}}function yt(){return s.filter(function(){return n(this).data("view")=="interior"})}function li(t){n(".views-wrap").stop().fadeTo("fast",0,function(){wf(t),aston.w.trigger("am.configurator.hotspots.draw"),aston.w.trigger("am.configurator.showControls");var i=oi();i.done(function(i){pf(t);var u=si(i);u.done(function(){pt(!0),et(r[t].environments[0].value),n(".views-wrap, .menu-wrap").stop().fadeTo("slow",1,function(){aston.w.trigger("am.configurator.onLoadingComplete"),aston.w.trigger("am.configurator.menu.show")})})})})}function kf(){var u=n("#accessories"),i,t;return n.Deferred(function(n){i={options:r.options,accessories:r.accessories},t=of.tmpl(i),u.empty().append(t).show(),setTimeout(function(){n.resolve()},500)}).promise()}function ne(){var r=u.find("#share"),t;return n.Deferred(function(u){if(wt){t=vf.tmpl(),r.empty().append(t).show();var e={configuratorMode:!0,language:i.language,onInitialise:function(){wt=!1},onSubmit:function(){wt=!0}},f=n.extend(!0,{},i.drive,e);$clone=n("#driveForm").appendTo(n("#drive-form-placeholder")).show(),$cloneComplete=n("#driveFormComplete").clone().attr("id","driveFormComplete-Copy").appendTo(n("#drive-form-placeholder")),$clone.drive(f)}else r.show();u.resolve()}).promise()}function pt(n){var t=_.sortBy(r[f].environments,function(n){return parseInt(n.order)}),i;if(n&&t&&t.length){for(i=0;i<t.length;i++)t[i].selected=!1;t[0].selected=!0}cu.tmpl(t).appendTo(tt.find("ul").empty()),ar(n)}function ar(t){var u=tt.find(".environments-inner"),f=u.find(".environment:visible"),r=0,i;n.each(f,function(t,i){r+=n(i).outerWidth()+3}),u.css("width",r),i=tt.getNiceScroll(),i.length==1?t?(i[0].remove(),ct(tt,".environments-inner",!0)):i.resize():ct(tt,".environments-inner",!0)}function ct(n,t,i){n.niceScroll(t,{touchbehavior:ir,autohidemode:i,cursorcolor:"#000",cursoropacitymax:1,cursorwidth:7,cursorborderradius:0,smoothscroll:!1})}function et(t,i){var l=n(".environment"),s=_.filter(r[f].ui[t],function(n){return n.available==="true"}),c=_.groupBy(s,function(n){return n.group}),u=_.find(s,function(n){return n.selected==="true"}),o=_.find(r[f].environments,function(n){return n.value==t}),e,h;o?(pu(t),vt.hide().empty(),e=n.map(c,function(n,t){return[{name:t,options:n}]}),h={environment:o,selected:{title:u&&(u.fname||u.name)||"Not Selected",hex:u&&u.colour,img:u&&u.uiLargeImage},palettes:_.sortBy(e,function(n){return n.name})},hf.tmpl(h).appendTo(vt),hr(),df(e),vt.fadeIn("fast")):et(r[f].environments[0].value,tt.find("a").first()),typeof i!="undefined"&&(l.removeClass("on"),i.parent().addClass("on"))}function df(t){for(var o=56,r=0,i,f,e,u=0;u<t.length;u++)i=t[u],i&&i.options&&(i.options.length==1&&(r+=30),r+=i.options.length*o,r+=30);r>=gf[aston.theme]&&(f=n(".options-wrap").find(".scroll-wrap"),e=f.find(".scroll-content"),e.css("width",r),ct(f,".options-wrap .scroll-content",!1))}function hr(){n(".scroll-content").find(".option").tooltip({position:{my:"bottom+65",at:gu[aston.theme]},show:!1,hide:!1,open:function(){aston.mobileWebkit&&Modernizr.touch&&n(this).click()}})}function ur(n){var f=[],i,u,t;for(i in r.selection[n])u=r.selection[n][i].toString(),t=_.find(r[n],function(n){return n.id==u}),t&&f.push(new er("",n==="options"?t.title:t.text,t.img,""));return f}function er(n,t,i,r){this.environment=n,this.option=t,this.imageUrl=i,this.hex=r}function ai(n,t){if(!t)return"fff";var i=_.find(r[f]&&r[f].ui&&r[f].ui[n]||{},function(n){return n.name.toUpperCase()==t.toUpperCase()});return i&&i.colour||"fff"}function vr(n){return n/te[aston.theme][0]}function lr(n){f!==n&&(f=n)}function o(t){var i=ai(t,r.selection[f][t]);n("#"+t).css("background","#"+i)}function gt(n){var t;n?(t=h+1,h=t>7?0:t):(t=h-1,h=t<0?7:t>7?7:t)}function vu(){if(i.showInteriorRoof)switch(e){case 1:e=2;break;case 2:e=3;break;default:e=1}else e=i.isConvertible&&r.selection.exterior.rp&&r.selection.exterior.rp=="up"?e==1?3:1:e==1?2:1}function fr(n,t){r.changed[f][n]=t,r.selection[f][n]=t,bi=!0}function pu(n){di=n}function wu(n,t){n.removeClass("true"),t.addClass("true")}function ku(n,t,i){var e=r[f].ui[t],u=_.find(e,function(n){return n.name==i});u&&(n.find("h3").html(u.fname||u.name),u.uiLargeImage?n.find("img").attr("src",u.uiLargeImage):n.find("span").css("background-color","#"+u.colour||""))}function sr(n,t){var o;g=!0;var u=sf.tmpl(n).appendTo(p).show(),c=_.keys(n.palette).length,h=50,s=0,f=0,r=0,e;for(o in n.palette)e=n.palette[o],f+=e.length;s=Math.floor(f/lu())+1,r=s*h+c*(i.q?aston.theme=="xlarge"?105:90:55),r>=ue[aston.theme]&&(u.find(".scroll-content").css("height",r),ct(u.find(".scroll-wrap"),".colour-palette .scroll-content",!0)),u.stop().animate({bottom:0,easing:"easeInExpo"},500,function(){t.parent().addClass("on"),v=!0,g=!1})}function lu(){var t=6,n={xlarge:28,large:22,medium:17,small:15};return n[aston.theme]}function st(){var t=p.find(".colour-palette");return n.Deferred(function(i){t.stop().animate({bottom:-t.outerHeight()},250,function(){v=!1,nt.children().removeClass("on"),n(this).remove(),i.resolve()})}).promise()}function uu(n,t,r,u){var v,o=[],c=[],a=[],h=0,f,s,e,l;for(f in u)f!=="PC"&&f!=="PCA"&&f!=="PCS"&&f!=="SC"&&f!=="SCA"&&f!=="SCS"&&(s=_.find(t,function(n){return n.value==f}),e=_.find(r[f],function(n){return n.name==u[f]}),e&&o.push(new er(s&&s.name,e&&(e.fname||e.name),e.img||"",e.colour||"")));return h=o.length,h>i.maxNumberSummaryOptionsPerColumn?(l=Math.ceil(h/2),c=o.splice(0,l),a=o):c=o,v={column1:c,column2:a}}function hi(t,i,r,u,f){for(var e=i,s=0,o=e.length-1;o>=0;o--)(function(i){tu(i,!1,u,f,function(){if(ht[t][i]=this,s++,s>=e.length){for(var u=0;u<e.length;u++)du(r,ht[t][e[u]]);n("#"+r).find(".loading").hide()}})})(e[o])}function du(t,i){n("#"+t).append(i)}function yu(){var t=u.find("#summary");return n.Deferred(function(i){n.when(rt("exterior","small"),rt("interior","small")).done(function(n,r){var f=uu("exterior",n.environments,n.ui,n.selection),u=uu("interior",r.environments,r.ui,r.selection),o={exterior1:f&&f.column1,exterior2:f&&f.column2,interior1:u&&u.column1,interior2:u&&u.column2,accessories:ur("accessories"),options:ur("options")},e=cf.tmpl(o);t.empty().append(e).show(),hi("exterior",n.images,"exterior",dt[aston.theme][0],dt[aston.theme][1]),hi("interior",r.images,"interior",dt[aston.theme][0],dt[aston.theme][1]),i.resolve()})}).promise()}function rt(t){return n.Deferred(function(n){var f={},u=[],s={exterior:"ext",interior:"int"},o={model:i.modelId,method:"layer",showinitd:!0,imgsize:i.debug?"1500":k[aston.theme][0],view:s[t],rotation:i.defaultRotation,viewnum:i.q&&t=="interior"?0:1,changed:{},selection:r.selection[t]||{},lang:ui()},e=kt("interior",o);e.done(function(t){if(t){i.q&&(t=t.replace(/;/g,"").replace(/\(|\)/g,""),t=JSON.parse(t));for(var r in t.layers)u.push(t.layers[r]);f={images:u,environments:t.initd.env,ui:t.ui,selection:t.selection},n.resolve(f)}})}).promise()}function dr(n){var i=r.selection[n],t,u;if(i&&i.length>0)for(t=0;t<=i.length;t++)u=_.find(r[n],function(n){return n.id==i[t]}),u&&(u.selected=!0)}function gr(n){var t;switch(n){case"save":t=i.useChineseApi?"http://vhapi.chinacloudsites.cn/api-save.php":"http://vhapi.azurewebsites.net/api-save.php";break;case"retrieve":t=i.useChineseApi?"http://vhapi.chinacloudsites.cn/api-retrieve.php":"http://vhapi.azurewebsites.net/api-retrieve.php";break;case"interior":default:t=i.useChineseApi?"http://vhapi.chinacloudsites.cn/api-interior.php":"http://vhapi.azurewebsites.net/api-interior-v2.php"}return t}function kt(t,r){if(i.q){if(n.support.cors)return n.post(gr(t),{json:JSON.stringify(r)});var u;switch(t){case"save":u="Save";break;case"retrieve":u="Retrieve";break;case"interior":default:u="Get"}return n.post("/Webservices/ConfiguratorWS.asmx/"+u,{json:JSON.stringify(r)})}return n.getJSON(gr(t)+"?callback=?",{json:JSON.stringify(r)})}function oi(t){return n.Deferred(function(n){var u=[],c={exterior:"ext",interior:"int",side:"int"},s={model:i.modelId,method:t?"stitch":"layer",showinitd:!0,imgsize:i.debug?"1500":k[aston.theme][0],view:c[f],rotation:h,viewnum:e,changed:r.changed[f]||{},selection:r.selection[f]||{},lang:ui()},o=kt("interior",s);o.done(function(t){var c,s,y,l,h,v,e,o,a;if(t){i.q&&(t=t.replace(/;/g,"").replace(/\(|\)/g,""),t=JSON.parse(t)),r.views=t.initd.views||[],r.accessories=t.initd.accessories||[],r.features=t.initd.features||[],r.options=t.initd.options||[],r.environments[f]=t.initd.env||[],nr&&(r.selection.accessories.length>0&&dr("accessories"),r.selection.options.length>0&&dr("options"),nr=!1),c=[];for(l in t.ui)s=_.find(r.environments[f],function(n){return n.value==l&&n.navArea&&n.navArea=="0"}),s?(y=s.value==di,c.push(new bu(s.name,s.value,s.order,y))):(i.debug||i.logMessages)&&console.log(new Date+" unable to find "+l);r[f].environments=c;for(v in t.layers)h=t.layers[v],i.debug&&(h=h.replace("http://cdn.astonmartin.com/","http://astonmartin.blob.core.windows.net/")),u.push(h);if(i.syncedEnvironments)for(a in i.syncedEnvironments)e=i.syncedEnvironments[a],o=t.selection[e.environment],o&&(f=="exterior"?(r.changed.interior[e.environment]=o,r.selection.interior[e.environment]=o,e.updateColour&&(r.changed.interior[e.updateColour]=o,r.selection.interior[e.updateColour]=o)):(r.changed.exterior[e.environment]=o,r.selection.exterior[e.environment]=o));r.selection[f]=t.selection,r[f].ui=t.ui,r.changed[f]={},(i.debug||i.logMessages)&&console.log(new Date+" "+u.length+" images required"),n.resolve(u)}})}).promise()}function bu(n,t,i,r){this.name=n,this.value=t,this.order=i,this.selected=r}function su(){Modernizr.canvas?gi.clearRect(0,0,ut(aston.theme),ot(aston.theme)):eu.empty()}function hu(){Modernizr.canvas&&(n(vi).attr({width:ut(aston.theme),height:ot(aston.theme)}),gi=vi.getContext("2d"))}function si(t){var e=n.Deferred(),i;t.length==0&&e.resolve();var r=t,u=r.length,o=0;for(i=u-1;i>=0;i--)(function(n){tu(n,ht[f][n]||!1,ut(b),ot(b),function(){var t=this,i;if(typeof t=="object"&&t.height>0&&t.width>0&&(ht[f][n]=t),o++,o==u){for(su(),i=0;i<u;i++)t=ht[f][r[i]],t&&au(t);e.resolve()}})})(r[i]);return e.promise()}function au(n){Modernizr.canvas?gi.drawImage(n,0,0,ut(aston.theme),ot(aston.theme)):eu.append(n)}function tu(n,t,i,r,u){if(t&&t.src===n)return u&&u.call(t);var f=new Image;return f.onload=function(){this.width=i,this.height=r,typeof u=="function"&&u.call(this)},f.onerror=function(){typeof u=="function"&&u.call(!1)},f.src=n,this}function ut(n){return k[n][0]}function ot(n){return k[n][1]}var i={},nu={modelId:14,modelName:"",maxNumberSummaryOptionsPerColumn:5,logging:!1,defaultRotation:0,defaultView:"exterior",defaultViewnum:0,drive:{campaignId:66},images:{options:"http://cdn.astonmartin.com/sitefinity/configurator/options-1.jpg?sfvrsn=2",accessories:"http://cdn.astonmartin.com/sitefinity/configurator/accessories-1.jpg?sfvrsn=2",summary:{options:"http://cdn.astonmartin.com/sitefinity/configurator/options-1.jpg?sfvrsn=2",accessories:"http://cdn.astonmartin.com/sitefinity/configurator/accessories-1.jpg?sfvrsn=2"}},shareTitle:"Aston Martin Configurator",showPdf:!0,showSeperator:5,showInformation:!1,showHotspots:!0,showInspire:!1,showBodyStyles:!1,showInteriorRoof:!1,configBodyStyles:{helperText:"Switch Bodystyle: ",coupeText:" Coupe",convertibleText:" Volante",isVolante:!1,convertibleModelId:!1},removeColourPalette:!1,language:"en",debug:!1,syncedEnvironments:[],q:!1,isConvertible:!1,useChineseApi:!1,useOriginalCdn:!1,logMessages:!1};i=n.extend(!0,{},nu,t);var f=i.defaultView,r={exterior:{},interior:{},changed:{exterior:{},interior:{}},selection:{exterior:{},interior:{},accessories:[],options:[]},environments:{exterior:[],interior:[]},views:[]},ei=!1,e=i.defaultViewnum,h=i.defaultRotation,ht={exterior:{},interior:{},side:{}},k={xlarge:[1490,730],large:[1160,568],medium:[890,436],small:[760,372]},dt={xlarge:[472,231],large:[345,168],medium:[273,133],small:[231,113]},gf={xlarge:1192,large:934,medium:712,small:608},gu={xlarge:"left-180%",large:"left-45%",medium:"left-25%",small:"center"},te={xlarge:[1,1],large:[1.29,1.2],medium:[1.67,1.67],small:[1.96,1.96]},ue={xlarge:405,large:405,medium:210,small:210},v=!1,g=!1,di,ki=!1,nr=!1,bi=!1,it=!0,wt=!0,pi=!1,ir="ontouchend"in document,b=aston.theme,ni=!0,wi=!1,rr=1,d,ei=!1,u=n(this),vi=u.find("#master")[0],gi,eu=u.find("#canvas"),ou=u.find(".item"),pr=u.find(".view"),s=u.find(".view-change"),cr=u.find(".view-loading"),tr=u.find("#loading"),p=u.find(".canvas-wrap"),nt=u.find(".colour-controls"),yr=nt.find(".colour-selector"),tt=u.find(".environments-wrap"),vt=u.find(".options-wrap").find(".options-inner"),w=u.find("#configurator-startup"),a=u.find(".interior-views"),c=u.find(".inspire-wrap"),l,ft,at,ti,bt=u.find(".cta"),y=c.width(),yi=!1,cu=n("#environmentTemplate"),hf=n("#paletteTemplate"),sf=n("#colourPaletteTemplate"),of=n("#optionsAndAccessoriesTemplate"),cf=n("#summaryTemplate"),vf=n("#submitTemplate"),af=n("#viewsTemplate");return this.reInit=function(t){i=n.extend(!0,{},nu,t),f=i.defaultView,e=i.defaultViewnum,h=i.defaultRotation,v=!1,g=!1,it=!0,wt=!0,r={exterior:{},interior:{},changed:{exterior:{},interior:{}},selection:{exterior:{},interior:{},accessories:[],options:[]},additionalInfo:{exterior:!0,interior:!0},environments:{exterior:[],interior:[]}},c.empty(),iu(),n(".menu-wrap .item").removeClass("on"),s.first().click()},aston.configurator=function(){var n=function(){return ci()};return{getShareUrl:n}}(),aston.templateCallbacks=function(){var u=function(n){return(n+1)%4!=0?"":"last"},f=function(n){return n?"on":""},r=function(n){return n?aston.generic.getTranslatedText(i.language,"configurator","remove"):aston.generic.getTranslatedText(i.language,"configurator","add")},n=function(n){return n=="undefined"||n=="null"||n===""?"&nbsp;":n},t=function(n){var t="";if(i.q)switch(n){case"Pacific Coast Highway":t="A collection inspired by the bright colours and beautiful coastline seen all along this All-American road.";break;case"Contemporary":t="Both eye catching and subtle visual effects combine with stylish and sleek finishes.";break;case"Autumn Winter":t="Rich hues and tones all emanating the warmth and depth of Autumn and Winter.";break;case"Heritage":t="Featuring many past and original colours from Aston Martin’s rich history and storied model line-up.";break;case"Fast Track":t="The colours which best represent our core values of technical excellence, supreme confidence, understatement and elegance.";break;case"Specials":t="Truly striking exteriors including tri-coat and tinted clear coat finishes which require the height of paint blending and craftsmanship.";break;case"Spring & Summer":t="Drenched in the radiance and vibrancy of Spring and Summer.";break;default:t=""}return t};return getSummaryImage=function(n){return i.images.summary[n]},getOptionsAndAccessoriesImage=function(n,t){return n&&n!==""?n:i.images[t]},hasText=function(n){return n===undefined||n===null||n.length===0||n===""||n===" "?!1:!0},showPdf=function(){return ir?!1:i.showPdf},addSeperator=function(n){return n&&n.options.length>=i.showSeperator?"seperator":""},showInformation=function(n){return i.showInformation&&hasText(n)?!0:!1},isEmptyObject=function(n){return _.isEmpty(n)},getTranslatedText=function(n){return aston.generic.getTranslatedText(i.language,"configurator",n)},isArray=function(n){return _.isArray(n)},{getPositionCssClass:u,hasOptionBeenSelected:f,getOptionAddText:r,getPaletteCategoryText:n,getPaletteDescriptionText:t,getSummaryImage:getSummaryImage,getOptionsAndAccessoriesImage:getOptionsAndAccessoriesImage,hasText:hasText,showPdf:showPdf,addSeperator:addSeperator,showInformation:showInformation,isEmptyObject:isEmptyObject,getTranslatedText:getTranslatedText,isArray:isArray}}(),lf(),this}}(jQuery),$("#form").click(function(){test()})